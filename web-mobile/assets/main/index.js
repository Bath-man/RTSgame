System.register("chunks:///_virtual/AIPlayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./belongingManager.ts","./UnitsManager.ts","./gameManager.ts","./MapManager.ts"],(function(e){var t,n,i,r,s,a,c,o,f,u,h,p,l,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){s=e.cclegacy,a=e._decorator,c=e.CCInteger,o=e.randomRange,f=e.Component},function(e){u=e.belongingManager},function(e){h=e.UnitsManager,p=e.UnitPrefrence},function(e){l=e.gameManager},function(e){m=e.MapManager}],execute:function(){var d,P,g,I,y;s._RF.push({},"35b9ayJx8RPF5NSjA75B+AU","AIPlayer",void 0);var R=a.ccclass,U=a.property;e("AIPlayer",(d=R("AIPlayer"),P=U(c),d((y=t((I=function(e){function t(){for(var t,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t=e.call.apply(e,[this].concat(s))||this,i(t,"team",y,r(t)),t.AIResponseTime=4,t._timer=void 0,t._lastTimeRes=void 0,t.difficulty=void 0,t._core=void 0,t}n(t,e);var s=t.prototype;return s.onLoad=function(){this.setDif(1),this._timer=this.AIResponseTime},s.startPlay=function(){this.cheatResAdd(0,this.difficulty),this._core=h.instance.CoreOfTeam(this.team),this._lastTimeRes=[];for(var e=0;e<u.ResNum;e++)this._lastTimeRes[e]=u.instance.getRes(this.team,e)},s.setDif=function(e){this.difficulty=e},s.update=function(e){if(this._timer-=e,this._timer<0){this.cheatResAdd(0,this.difficulty);var t=u.instance.Reses[this.team][0]-this._lastTimeRes[0];t<5?(this.putUnitInPrefrence(p.eco),this.putUnitInPrefrence(p.eco)):t<10?(this.putUnitInPrefrence(p.eco),this.putUnitInPrefrence(p.eco),this.putUnitInPrefrence(p.defence),this.putUnitInPrefrence(p.defence)):t<15?(this.putUnitInPrefrence(p.eco),this.putUnitInPrefrence(p.defence),this.putUnitInPrefrence(p.offensive)):(this.putUnitInPrefrence(p.defence),this.putUnitInPrefrence(p.offensive),this.putUnitInPrefrence(p.offensive));for(var n=0;n<u.ResNum;n++)this._lastTimeRes[n]=u.instance.getRes(this.team,n);this._timer+=this.AIResponseTime}},s.putUnitInPrefrence=function(e){var t=h.instance.getUnitTypeInPrefrence(e),n=m.instance.randomGeneratePosAwayFromCore(this.team);0==e&&(n=m.instance.randomGeneratePosToMine(this.team,0)),null!=n&&l.instance.tryToPutUnit(n,t,this.team)},s.RandomDecide=function(e){return o(0,1)<e},s.cheatResAdd=function(e,t){u.instance.addRes(this.team,e,t)},t}(f)).prototype,"team",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),g=I))||g));s._RF.pop()}}}));

System.register("chunks:///_virtual/AnimStateType.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"b7517MjqeBHX6R9MJ5vTdfC","AnimStateType",void 0);t("AnimStateType",function(t){return t.Idle="Idle",t.Move="Move",t.PreAttack="PreAttack",t.Attack="Attack",t}({}));e._RF.pop()}}}));

System.register("chunks:///_virtual/basic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Unit.ts","./UnitsManager.ts","./MathTool.ts","./UnitTypeInform.ts","./MapManager.ts","./AnimStateType.ts"],(function(t){var e,i,n,r,a,s,o,c,h,u,d,m;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,r=t.Vec2,a=t.randomRange},function(t){s=t.UnitState,o=t.Unit},null,function(t){c=t.MathTool},function(t){h=t.UnitType,u=t.UnitTypeInform},function(t){d=t.MapManager},function(t){m=t.AnimStateType}],execute:function(){var f;i._RF.push({},"56025qYbO1He7PuIUjPETu3","basic",void 0);var p=n.ccclass,l=(n.property,t("basic",p("basic")(f=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var n=i.prototype;return n.AddPriceMapAndPrefrenceMapInUnitManager=function(){throw new Error("Method not implemented.")},n.setMyType=function(){this.type=h.basic},n.attack=function(){var t=this.target.node.getPosition().subtract(this.node.getPosition());this.move(0,new r(t.x,t.y)),this.target.hurt(this.strength,this)},n.loader=function(){this.maxhp=30,this.guardRange=300,this.chaseRange=800,this.statereg(s.Idle,new l),this.statereg(s.ReturnToGuard,new g),this.statereg(s.Wonder,new T),this.statereg(s.Chase,new v),this.statereg(s.Circling,new y),this.statereg(s.PreAttack,new _),this.statereg(s.Attack,new I),this.statereg(s.Freeze,new w),t.prototype.loader.call(this)},n.start=function(){},n.onLoad=function(){this.node.getComponent(u).Unit=this},n.update=function(t){this.UnitUpdate(t)},i}(o))||f),t("basicStateIdle",function(){function t(){this.state=s.Idle,this.moveTime=0,this.repeatTime=0}var e=t.prototype;return e.StateEnter=function(t){t.anim.play(m.Idle),t.giveupTarget(),this.repeatTime=0,this.moveTime=0,this.oneAct(t)},e.update=function(t,e){this.moveTime+=e,this.moveTime>t.responseTime*a(.7,1.3)&&(this.oneAct(t),this.moveTime=0,this.repeatTime+=1)},e.oneAct=function(t){if(t.hastarget())throw new Error("Idle should have no target");t.searchEnemy()?t.stateTransform(s.Chase):t.hasGuard()&&t.isFarFromGuard()?t.stateTransform(s.ReturnToGuard):this.repeatTime>=t.actionRepeat&&t.stateTransform(s.Wonder)},t}())),g=t("basicStateReturnToGuard",function(){function t(){this.state=s.ReturnToGuard,this._dir=null,this._time=0}var e=t.prototype;return e.StateEnter=function(t){this.detect(t)||t.stateTransform(s.Idle),this.directionConfirm(t)},e.update=function(t,e){this._time-=e,t.move(e,this._dir),this._time<0&&(this.detect(t)?this.directionConfirm(t):t.stateTransform(s.Idle))},e.directionConfirm=function(t){var e=d.instance.SearchWay(t.node.position,t.guard.node.position,1);if(null==e)return t.stopGuard(),void t.stateTransform(s.Idle);var i=e[1].subtract(new r(t.node.position.x,t.node.position.y)),n=i.length();this._dir=i.normalize(),this._time=n/t.Speed},e.detect=function(t){return!(!t.hasGuard()||!t.isFarFromGuard())},t}()),T=t("basicStateWonder",function(){function t(){this.state=s.Wonder,this.wondertime=void 0,this.dir=void 0}var e=t.prototype;return e.StateEnter=function(t){if(null!=t.guard&&t.isFarFromGuard()&&(this.dir=t.ToGuardV2(),null!=this.dir)){this.wondertime=a(.8*t.responseTime,1.2*t.responseTime);var e=a(-45,45);this.dir=c.Ve2Rotate(this.dir,e)}else{this.wondertime=a(.8*t.responseTime,1.2*t.responseTime);var i=a(0,2*Math.PI);this.dir=new r(Math.cos(i),Math.sin(i))}},e.update=function(t,e){t.move(e,this.dir),this.wondertime-=e,this.wondertime<0&&t.stateTransform(s.Idle)},t}()),v=t("basicStateChase",function(){function t(){this.state=s.Chase,this._dir=null,this._time=0}var e=t.prototype;return e.StateEnter=function(t){this.directionConfirm(t),this.detect(t)&&t.targetInReach()&&t.stateTransform(s.Circling)},e.update=function(t,e){this._time-=e,t.move(e,this._dir),this._time<0&&(this.detect(t)?t.targetInReach()?t.stateTransform(s.Circling):this.directionConfirm(t):t.stateTransform(s.Idle))},e.directionConfirm=function(t){var e=Math.PI*a(-t.moveOffsetAngle,t.moveOffsetAngle)/180,i=d.instance.SearchWay(t.node.position,t.target.node.position,1);if(null==i)return t.giveupTarget(),void t.stateTransform(s.Idle);var n=i[1].subtract(new r(t.node.position.x,t.node.position.y));this._dir=c.Ve2Rotate(new r(n.x,n.y),e).normalize(),this._time=t.responseTime},e.detect=function(t){return!(!t.hastarget()||!t.targetInChaseReach())},t}()),y=t("basicStateCircle",function(){function t(){this.state=s.Circling}var e=t.prototype;return e.StateEnter=function(t){},e.update=function(t,e){t.hastarget()?t.attackReady()?t.stateTransform(s.PreAttack):t.targetInReach()?this.circlemove(t,e):t.stateTransform(s.Chase):t.stateTransform(s.Idle)},e.circlemove=function(t,e){},t}()),_=t("basicStatePreAttack",function(){function t(){this.state=s.PreAttack,this._time=0}var e=t.prototype;return e.StateEnter=function(t){this._time=0,t.anim.play(m.PreAttack)},e.update=function(t,e){this._time+=e,this._time>t.attackPrepare&&t.stateTransform(s.Attack)},t}()),I=t("basicStateAttack",function(){function t(){this._time=void 0,this.state=s.Attack}var e=t.prototype;return e.StateEnter=function(t){if(null!=t.target){var e=t.target;e.hurtexpect(t.strength),e.hurt(t.strength,t),t._attackcooldown=t.attackInterval}else this._time=0},e.update=function(t,e){this._time>0?this._time-=e:t.stateTransform(s.Circling)},t}()),w=t("basicStateFreeze",function(){function t(){this.state=s.Freeze,this.time=3}var e=t.prototype;return e.StateEnter=function(t){this.time=3},e.update=function(t,e){this.time>0?this.time-=e:t.stateTransform(s.Idle)},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/basicBullet.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Bullet.ts","./bulletsManager.ts","./bulletTypeInform.ts"],(function(t){var e,n,l,u,s,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,l=t._decorator},function(t){u=t.Bullet},function(t){s=t.bulletsManager},function(t){i=t.BulletType,o=t.bulletTypeInform}],execute:function(){var c;n._RF.push({},"d7923HwBsBNaLbMwYF9DQhf","basicBullet",void 0);var r=l.ccclass;l.property,t("basicBullet",r("basicBullet")(c=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var l=n.prototype;return l.explode=function(){this.target.hp>0&&this.target.hurt(this.damage,this.source),s.instance.bulletDead(this)},l.setMyType=function(){this.type=i.basicBullet},l.onLoad=function(){this.node.getComponent(o).bullet=this},l.update=function(t){this.BulletUpdate(t)},n}(u))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/basicHealer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Unit.ts","./UnitTypeInform.ts","./basic.ts","./UnitsManager.ts","./bulletsManager.ts","./bulletTypeInform.ts"],(function(t){var e,n,a,i,s,r,o,c,h,l,u,g,p,f,d,b,m;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,a=t._decorator,i=t.Vec2},function(t){s=t.UnitState,r=t.Unit},function(t){o=t.UnitType,c=t.UnitTypeInform},function(t){h=t.basicStateIdle,l=t.basicStateWonder,u=t.basicStateChase,g=t.basicStateCircle,p=t.basicStatePreAttack,f=t.basicStateFreeze},function(t){d=t.UnitsManager},function(t){b=t.bulletsManager},function(t){m=t.BulletType}],execute:function(){var v;n._RF.push({},"44e21pp8f9N8oVxvlllbXJO","basicHealer",void 0);var y=a.ccclass,k=(a.property,t("basicHealer",y("basicHealer")(v=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var a=n.prototype;return a.AddPriceMapAndPrefrenceMapInUnitManager=function(){throw new Error("Method not implemented.")},a.setMyType=function(){this.type=o.healer},a.attack=function(){var t=this.target.node.getPosition().subtract(this.node.getPosition());this.move(0,new i(t.x,t.y)),this.target.healexpect(this.strength),b.instance.CreateBullet(this,this.target,m.healBullet,400,this.strength).node.position=this.node.getPosition()},a.searchEnemy=function(){var t=d.instance.FindLatestHurtMate(this);return!(null==t||i.distance(t.node.getPosition(),this.node.getPosition())>=this.searchRange)&&(this.target=t,this.targetInChaseReach()?(this.target=t,this.target.chasers.push(this),!0):(this.target=null,!1))},a.loader=function(){this.maxhp=10,this.strength=3,this.searchRange=500,this.attackRange=300,this.attackInterval=5,this.attackPrepare=.25,this.chaseRange=2e3,this.statereg(s.Idle,new h),this.statereg(s.Wonder,new l),this.statereg(s.Chase,new u),this.statereg(s.Circling,new g),this.statereg(s.PreAttack,new p),this.statereg(s.Attack,new k),this.statereg(s.Freeze,new f),t.prototype.loader.call(this)},a.onLoad=function(){this.node.getComponent(c).Unit=this},a.update=function(t){this.UnitUpdate(t)},n}(r))||v),t("basicHealerStateAttack",function(){function t(){this.state=s.Attack,this._time=void 0}var e=t.prototype;return e.StateEnter=function(t){if(null!=t.target){var e=t.target;t.attack(),e.hpexpect==e.maxhp&&t.giveupTarget(),t._attackcooldown=t.attackInterval,this._time=t.attackRecover}else this._time=0},e.update=function(t,e){this._time>0?this._time-=e:t.stateTransform(s.Circling)},t}()));n._RF.pop()}}}));

System.register("chunks:///_virtual/belongingManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var s,t,n,i,r,l,o,a,u;return{setters:[function(e){s=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,o=e.Node,a=e.Label,u=e.Component}],execute:function(){var c,h,R,p,g,f;r._RF.push({},"d3331fE3J9HrZQfFTZ8yWcS","belongingManager",void 0);var d=l.ccclass,b=l.property;e("belongingManager",(c=d("belongingManager"),h=b(o),c(((f=function(e){function s(){var t;return t=e.call(this)||this,n(t,"labels",g,i(t)),t.Reses=void 0,s.instance=i(t),t}t(s,e);var r=s.prototype;return r.Reload=function(){this.Reses=[]},r.getRes=function(e,s){return null==this.Reses[e]&&(this.Reses[e]=null),null==this.Reses[e][s]&&(this.Reses[e][s]=0),this.Reses[e][s]},r.addRes=function(e,s,t){null==this.Reses[e]&&(this.Reses[e]=[]),null==this.Reses[e][s]&&(this.Reses[e][s]=0),this.Reses[e][s]+=t,0==e&&this.updateRes(e,s)},r.subRes=function(e,s,t){return null!=this.Reses[e]&&null!=this.Reses[e][s]&&(!(this.Reses[e][s]<t)&&(this.Reses[e][s]-=t,0==e&&this.updateRes(e,s),!0))},r.updateRes=function(e,s){if(null==this.labels[s])throw new Error("possesion:no label Node!");this.labels[s].getComponent(a).string=String(this.Reses[e][s])},s}(u)).instance=void 0,f.ResNum=1,g=s((p=f).prototype,"labels",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=p))||R));r._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,s,i,n,r;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,s=t._decorator,i=t.Vec3,n=t.Vec2,r=t.Component}],execute:function(){var l;o._RF.push({},"3a56egxdyVOIKYGoWfx291f","Bullet",void 0);var u=s.ccclass;s.property,t("Bullet",u("Bullet")(l=function(t){function o(){var e;return(e=t.call(this)||this).target=null,e.source=null,e.damage=0,e.Speed=0,e.type=void 0,e._sourcepos=void 0,e._targetpos=void 0,e.setMyType(),e}e(o,t);var s=o.prototype;return s.loader=function(t,e,o,s){this.target=t,this.source=e,this.damage=o,this.Speed=s},s.move=function(t,e,o){var s=this.node.getPosition();this.node.position=new i(s.x+e.x*t*this.Speed,s.y+e.y*t*this.Speed,s.z)},s.BulletUpdate=function(t){if(null==this.source)throw new Error("bullet has no source");if(null==this.target)throw new Error("bullet has no target");this._targetpos=new n(this.target.node.getPosition().x,this.target.node.getPosition().y);var e=new n(this.node.position.x,this.node.position.y),o=this._targetpos.clone().subtract(e).normalize();this.move(t,o),this._targetpos.subtract(e).length()<this.Speed/20&&this.explode()},o}(r))||l);o._RF.pop()}}}));

System.register("chunks:///_virtual/bulletsManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./bulletTypeInform.ts"],(function(e){var t,l,n,i,r,s,a,u,o,p,c;return{setters:[function(e){t=e.applyDecoratedDescriptor,l=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized,r=e.createForOfIteratorHelperLoose},function(e){s=e.cclegacy,a=e._decorator,u=e.Prefab,o=e.instantiate,p=e.Component},function(t){c=t.bulletTypeInform,e("BulletType",t.BulletType)}],execute:function(){var h,f,b,y,d,v;s._RF.push({},"5e7a8UHM5RI/KKPKd6NsWjb","bulletsManager",void 0);var g=a.ccclass,B=a.property;e("bulletsManager",(h=g("bulletsManager"),f=B(u),h(((v=function(e){function t(){var l;return l=e.call(this)||this,n(l,"unitPrefabs",d,i(l)),l.types={},l.BulletExist=void 0,t.instance=i(l),l.BulletExist=[],l}l(t,e);var s=t.prototype;return s.RestartLoad=function(){if(this.BulletExist.length>0)for(var e,t=this.BulletExist.slice(),l=r(t);!(e=l()).done;){var n=e.value;this.bulletDead(n)}this.BulletExist.length=0},s.CreateBullet=function(e,t,l,n,i){void 0===i&&(i=null);var r=null,s=this.unitPrefabs[l];if(null==s)throw new Error("no such a bullet prefab:"+l);if(l in this.types||(this.types[l]=[]),0==this.types[l].length){var a=o(s);a.setParent(this.node),r=a.getComponent(c).bullet}else(r=this.types[l].pop()).node.active=!0;return null==i&&(i=e.strength),r.loader(t,e,i,n),this.BulletExist.push(r),r},s.bulletDead=function(e){this.types[e.type].push(e),e.target=null,e.node.active=!1},t}(p)).instance=void 0,d=t((y=v).prototype,"unitPrefabs",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),b=y))||b));s._RF.pop()}}}));

System.register("chunks:///_virtual/bulletTypeInform.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,l,r,n,i,o,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,l=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){i=e.cclegacy,o=e._decorator,u=e.Component}],execute:function(){var a,c,p,s,f;i._RF.push({},"b658aWv63xCzYN8HNvfg3iA","bulletTypeInform",void 0);var b=o.ccclass,y=o.property;e("BulletType",function(e){return e[e.basicBullet=0]="basicBullet",e[e.healBullet=1]="healBullet",e}({})),e("bulletTypeInform",(a=b("bulletTypeInform"),c=y(u),a((f=t((s=function(e){function t(){for(var t,l=arguments.length,i=new Array(l),o=0;o<l;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,r(t,"bullet",f,n(t)),t}return l(t,e),t}(u)).prototype,"bullet",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=s))||p));i._RF.pop()}}}));

System.register("chunks:///_virtual/cameraScaleButton.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIManager.ts"],(function(e){var t,n,r,o,i,a,c,s,u,l;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,c=e.CCBoolean,s=e.Node,u=e.Component},function(e){l=e.UIManager}],execute:function(){var p,f,h,y,d;i._RF.push({},"98bf4/cEZNKY7yxmJjPO5Qv","cameraScaleButton",void 0);var g=a.ccclass,m=a.property;e("cameraScaleButton",(p=g("cameraScaleButton"),f=m(c),p((d=t((y=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,r(t,"isHigher",d,o(t)),t}n(t,e);var i=t.prototype;return i.onLoad=function(){this.node.on(s.EventType.TOUCH_START,this.touched,this)},i.onDestroy=function(){this.node.off(s.EventType.TOUCH_START)},i.touched=function(){this.isHigher?l.instance.cameraHigher():l.instance.cameraLower()},i.update=function(e){},t}(u)).prototype,"isHigher",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),h=y))||h));i._RF.pop()}}}));

System.register("chunks:///_virtual/CircularSpellMagician.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Unit.ts","./UnitTypeInform.ts","./basic.ts","./bulletsManager.ts","./UnitsManager.ts","./bulletTypeInform.ts"],(function(t){var e,i,a,n,r,s,c,o,l,u,h,g,p,f;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){a=t.cclegacy,n=t._decorator},function(t){r=t.UnitState,s=t.Unit},function(t){c=t.UnitType,o=t.UnitTypeInform},function(t){l=t.basicStateCircle,u=t.basicStatePreAttack,h=t.basicStateFreeze},function(t){g=t.bulletsManager},function(t){p=t.UnitsManager},function(t){f=t.BulletType}],execute:function(){var d;a._RF.push({},"9284eBgr+ZHD6ZIp2rooS+Y","CircularSpellMagician",void 0);var m=n.ccclass,v=(n.property,t("CircularSpellMagician",m("CircularSpellMagician")(d=function(t){function a(){for(var e,i=arguments.length,a=new Array(i),n=0;n<i;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).targets=null,e}e(a,t);var n=a.prototype;return n.AddPriceMapAndPrefrenceMapInUnitManager=function(){throw new Error("Method not implemented.")},n.hastarget=function(){return null!=this.targets&&0!=this.targets.length},n.giveupTarget=function(){for(var t,e=this.targets.slice(),a=i(e);!(t=a()).done;){t.value.escapeFromChasing(this)}this.targets.length=0},n.searchEnemy=function(){if(this.targets=p.instance.FindEnemyInRange(this,this.attackRange),null==this.targets)return!1;for(var t,e=i(this.targets);!(t=e()).done;){t.value.chasers.push(this)}return!0},n.losetarget=function(t){if(void 0===t&&(t=null),null==this.targets)throw new Error("CircularSpellMagician 's target is null!");var e=this.targets.indexOf(t);if(!(e>-1))throw new Error("CircularSpellMagician donot has Such a target!");this.targets.splice(e,1)},n.setMyType=function(){this.type=c.CircularSpellMagician},n.attack=function(){for(var t,e=i(this.targets);!(t=e()).done;){var a=t.value,n=g.instance.CreateBullet(this,a,f.basicBullet,400);a.hurtexpect(this.strength),n.node.position=this.node.getPosition()}},n.loader=function(){this.targets=null,this.maxhp=20,this.strength=2,this.searchRange=400,this.attackRange=400,this.attackInterval=3,this.attackPrepare=.25,this.chaseRange=99999,this.statereg(r.Idle,new v),this.statereg(r.Circling,new l),this.statereg(r.PreAttack,new u),this.statereg(r.Attack,new y),this.statereg(r.Freeze,new h),t.prototype.loader.call(this)},n.onLoad=function(){this.node.getComponent(o).Unit=this},n.update=function(t){this.UnitUpdate(t)},a}(s))||d),t("CircularSpellMagicianIdle",function(){function t(){this.state=r.Idle,this._time=0}var e=t.prototype;return e.StateEnter=function(t){this._time=0},e.update=function(t,e){this._time+=e,t.attackReady()&&this._time>t.responseTime&&(t.searchEnemy()&&t.stateTransform(r.Circling),this._time=0)},t}())),y=t("CircularSpellMagicianStateAttack",function(){function t(){this.state=r.Attack,this._time=void 0}var e=t.prototype;return e.StateEnter=function(t){t.hastarget()?(t.attack(),this._time=t.attackRecover,t._attackcooldown=t.attackInterval):this._time=0,t.giveupTarget()},e.update=function(t,e){this._time>0?this._time-=e:t.stateTransform(r.Idle)},t}());a._RF.pop()}}}));

System.register("chunks:///_virtual/core.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Unit.ts","./UnitTypeInform.ts","./basic.ts","./CircularSpellMagician.ts","./bulletsManager.ts","./UnitsManager.ts","./Shooter.ts","./bulletTypeInform.ts"],(function(t){var e,n,i,a,r,s,o,c,h,u,l,p,g,f;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){a=t.UnitState,r=t.Unit},function(t){s=t.UnitType,o=t.UnitTypeInform},function(t){c=t.basicStateCircle,h=t.basicStatePreAttack},function(t){u=t.CircularSpellMagicianIdle},function(t){l=t.bulletsManager},function(t){p=t.UnitsManager},function(t){g=t.shooterStateAttack},function(t){f=t.BulletType}],execute:function(){var d;n._RF.push({},"498c3g2mRZElqd7ewpIRMjF","core",void 0);var y=i.ccclass;i.property,t("core",y("core")(d=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.AddPriceMapAndPrefrenceMapInUnitManager=function(){throw new Error("Method not implemented.")},i.setMyType=function(){this.type=s.core},i.attack=function(){var t=l.instance.CreateBullet(this,this.target,f.basicBullet,1500);this.target.hurtexpect(this.strength),t.node.position=this.node.getPosition()},i.loader=function(){this.maxhp=100,this.strength=9999,this.searchRange=800,this.attackRange=300,this.attackInterval=3,this.chaseRange=99999,this.statereg(a.Idle,new u),this.statereg(a.Circling,new c),this.statereg(a.PreAttack,new h),this.statereg(a.Attack,new g),t.prototype.loader.call(this)},i.onLoad=function(){this.node.getComponent(o).Unit=this},i.death=function(){this.hastarget()&&this.giveupTarget(),this.escapeFromChasingAll(),p.instance.CoreDestroyed(this.team)},i.update=function(t){this.UnitUpdate(t)},n}(r))||d);n._RF.pop()}}}));

System.register("chunks:///_virtual/damageText.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MathTool.ts","./TextManager.ts"],(function(i){var t,s,e,o,a,h,l,n,r,f;return{setters:[function(i){t=i.inheritsLoose},function(i){s=i.cclegacy,e=i._decorator,o=i.Label,a=i.Vec2,h=i.randomRange,l=i.Color,n=i.Component},function(i){r=i.MathTool},function(i){f=i.TextManager}],execute:function(){var m;s._RF.push({},"1e2ceEsvFJPjKm16DLzFqsW","damageText",void 0);var c=e.ccclass;e.property,i("damageText",c("damageText")(m=function(i){function s(){for(var t,s=arguments.length,e=new Array(s),o=0;o<s;o++)e[o]=arguments[o];return(t=i.call.apply(i,[this].concat(e))||this).dir=null,t.time=void 0,t.scale=void 0,t.halfTime=.5,t.floatTime=.4,t.gravity=void 0,t.offset=void 0,t.label=void 0,t.originPos=void 0,t.finalpos=void 0,t.isJump=void 0,t}t(s,i);var e=s.prototype;return e.onLoad=function(){this.label=this.node.getComponent(o)},e.messageLoader=function(i,t,s,e,o){this.label.color=s,this.isJump=o,this.label.fontSize=e<2?70*e:140,this.halfTime=0,this.floatTime=.6,this.originPos=t.clone(),this.node.position=t,this.dir=new a(0,0),this.time=0,this.scale=1,this.gravity=0,this.offset=0,this.label.string=i,this.finalpos=this.originPos},e.loader=function(i,t,s,e,o){this.label.color=e,this.isJump=o,this.label.fontSize=0,this.halfTime=.5,this.floatTime=.4,this.originPos=s.clone(),this.node.position=s,this.dir=i.normalize().multiplyScalar(100),this.dir=r.Ve2Rotate(this.dir,h(-20,20)),this.time=0,this.scale=20*Math.log10(t)+40,this.gravity=600*Math.log10(t)+300,this.offset=.5*this.gravity*(this.halfTime*this.halfTime),this.label.string=t.toString()},e.update=function(i){var t=this.originPos.clone();if(this.time+=i,this.time<2*this.halfTime){var s=this.time-this.halfTime;if(this.isJump?s=Math.abs(s):s>0&&(s=0),t.y+=this.offset-.5*this.gravity*s*s,t.y+=this.dir.y*this.time,t.x+=this.dir.x*this.time,this.time<this.halfTime){var e=Math.floor(this.time/this.halfTime*this.scale/2)+1;this.label.fontSize=e}}else if(this.time<2*this.halfTime+this.floatTime){var o=this.time-2*this.halfTime;t=this.finalpos;var a=this.label.color;this.label.color=new l(a.r,a.g,a.b,255*Math.abs(1-o/this.floatTime))}else f.instance.textRecycle(this);this.node.position=t,this.finalpos=t},s}(n))||m);s._RF.pop()}}}));

System.register("chunks:///_virtual/damageTextManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./damageText.ts","./TextManager.ts"],(function(e){var t,a,r,n,i,o,s,c,l,u,g,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){i=e.cclegacy,o=e._decorator,s=e.Prefab,c=e.instantiate,l=e.Color,u=e.Vec2},function(e){g=e.damageText},function(t){p=t.TextManager,e("TextManager",t.TextManager)}],execute:function(){var f,d,h,v,x;i._RF.push({},"8ce38Ij65RKlpMiPQGUAI7i","damageTextManager",void 0);var T=o.ccclass,M=o.property;e("damageTextManager",(f=T("damageTextManager"),d=M(s),f((x=t((v=function(e){function t(){var t;return t=e.call(this)||this,r(t,"labPref",x,n(t)),t.pools=void 0,t.pools=[],p.instance=n(t),t}a(t,e);var i=t.prototype;return i.genrateBasic=function(){var e=null;if(0==this.pools.length){var t=c(this.labPref);e=t.getComponent(g),t.setParent(this.node)}else(e=this.pools.pop()).node.active=!0;return e},i.generateMessage=function(e,t,a,r){var n=this.genrateBasic();return n.messageLoader(e,t,a,r,!1),n},i.generateText=function(e,t,a,r){void 0===r&&(r=l.RED);var n=this.genrateBasic();return n.loader(e,t,a,r,!0),n},i.generateTextHeal=function(e,t){var a=this.genrateBasic();return a.loader(new u(0,0),e,t,l.GREEN,!1),a},i.textRecycle=function(e){e.node.active=!1,this.pools.push(e)},t}(p)).prototype,"labPref",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=v))||h));i._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/gameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UnitsManager.ts","./MapManager.ts","./UIManager.ts","./resourceManager.ts","./belongingManager.ts","./damageTextManager.ts","./AIPlayer.ts","./bulletsManager.ts","./itemChoose.ts"],(function(e){var n,t,a,r,o,i,s,c,u,m,l,g,d,f,p,h,M,I,R;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,i=e._decorator,s=e.Node,c=e.random,u=e.Color,m=e.Component},function(e){l=e.UnitsManager},function(e){g=e.MapManager},function(e){d=e.UIManager},function(e){f=e.resourceManager},function(e){p=e.belongingManager},function(e){h=e.damageTextManager},function(e){M=e.AIPlayer},function(e){I=e.bulletsManager},function(e){R=e.itemChoose}],execute:function(){var v,y,b,C,T,S,P,_;o._RF.push({},"43606ByyypIgKwewShwsQ6G","gameManager",void 0);var w=i.ccclass,G=i.property;e("gameManager",(v=w("gameManager"),y=G(s),b=G(s),v(((_=function(e){function n(){var t;return t=e.call(this)||this,a(t,"restartButton",S,r(t)),a(t,"AINode",P,r(t)),t.ResSummonTime=10,t._ResSummonTimer=0,t.teamNumber=void 0,n.instance=r(t),t}t(n,e);var o=n.prototype;return o.start=function(){this.onGameStart()},o.onGameStart=function(){this.teamNumber=2,R.getInstance().addItem(0,0),R.getInstance().addItem(0,1),R.getInstance().addItem(0,2),R.getInstance().addItem(0,4),R.getInstance().addItem(0,5),p.instance.Reload(),l.instance.StartGame(),g.instance.Reload(60,60,[.2],[.2],c()),f.instance.RestartLoad(),I.instance.RestartLoad(),d.instance.restartLoader();var e=g.instance.randomGeneratePos(1),n=l.instance.CreateCore(0);n.node.position=e.clone(),e=g.instance.randomGeneratePos(1),(n=l.instance.CreateCore(1)).node.position=e.clone(),d.instance.moveCameraTo(l.instance.getCorePos(0)),p.instance.addRes(0,0,5),p.instance.addRes(1,0,5),this._ResSummonTimer=this.ResSummonTime,this.AINode.getComponent(M).startPlay()},o.gameOver=function(){this.restartButton.active=!0},o.update=function(e){if(this._ResSummonTimer-=e,this._ResSummonTimer<0){this._ResSummonTimer+=this.ResSummonTime;var n=g.instance.randomGeneratePos(1);f.instance.CreateRes(0,100).node.position=n.clone()}},o.tryToPutUnit=function(e,n,t,a){if(void 0===a&&(a=null),!g.instance.isOnGround(e))return null!=a&&h.instance.generateMessage("Not allowed to put here!",e,new u(200,50,50,255),a),!1;var r=l.instance.getPriceof(n);if(!p.instance.subRes(t,0,r))return null!=a&&h.instance.generateMessage("Not enough Resource!",e,new u(50,50,200,255),a),!1;var o=l.instance.CreateUnit(n,t);return null==o?(console.log("the team has defeated"),!1):(o.node.position=e,o.guard=l.instance.CoreOfTeam(t),!0)},n}(m)).instance=null,S=n((T=_).prototype,"restartButton",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=n(T.prototype,"AINode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=T))||C));o._RF.pop()}}}));

System.register("chunks:///_virtual/healBullet.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Bullet.ts","./bulletTypeInform.ts","./bulletsManager.ts"],(function(t){var e,l,n,u,o,s,i;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,n=t._decorator},function(t){u=t.Bullet},function(t){o=t.BulletType,s=t.bulletTypeInform},function(t){i=t.bulletsManager}],execute:function(){var a;l._RF.push({},"ff642F0kRZPDo1oOf1PP/3c","healBullet",void 0);var r=n.ccclass;n.property,t("healBullet",r("healBullet")(a=function(t){function l(){return t.apply(this,arguments)||this}e(l,t);var n=l.prototype;return n.explode=function(){this.target.hp>0&&this.target.heal(this.damage,this.source),i.instance.bulletDead(this)},n.setMyType=function(){this.type=o.healBullet},n.onLoad=function(){this.node.getComponent(s).bullet=this},n.update=function(t){this.BulletUpdate(t)},l}(u))||a);l._RF.pop()}}}));

System.register("chunks:///_virtual/hpbar.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,r,h,o,s,a,n,_,l,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,h=e.assertThisInitialized},function(e){o=e.cclegacy,s=e._decorator,a=e.CCInteger,n=e.CCFloat,_=e.Vec3,l=e.UITransform,d=e.Component}],execute:function(){var P,b,c,g,u,p,w,m,y;o._RF.push({},"48343p3Qt1K05yA6iaWLL+Z","hpbar",void 0);var f=s.ccclass,v=s.property;e("hpbar",(P=f("hpbar"),b=v(a),c=v(n),g=v(n),P((w=t((p=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(t=e.call.apply(e,[this].concat(o))||this)._redbar=void 0,t._whitebar=void 0,t._greenbar=void 0,t._redPro=void 0,t._whitePro=void 0,t._whiteProGoal=void 0,t._greenPro=void 0,t._delaytime=void 0,r(t,"maxLen",w,h(t)),r(t,"delaytimeMax",m,h(t)),r(t,"shorterSpeed",y,h(t)),t}i(t,e);var o=t.prototype;return o.onLoad=function(){this._redbar=this.node.getChildByName("redBar"),this._whitebar=this.node.getChildByName("whiteBar"),this._greenbar=this.node.getChildByName("greenBar"),this._delaytime=0},o.onEnable=function(){this.setBar(1)},o._barset=function(e,t){var i=new _((t*this.maxLen-this.maxLen)/2,0,0),r=this.maxLen*t;e.getComponent(l).width=r,e.position=i},o.setBar=function(e){e<0&&(e=0),e>1&&(e=1),this._barset(this._whitebar,e),this._barset(this._redbar,e),this._barset(this._greenbar,e),this._whitePro=e,this._whiteProGoal=e,this._redPro=e,this._greenPro=e},o.barShort=function(e){this._delaytime=this.delaytimeMax,this._greenPro-=e,this._greenPro<0&&(this._greenPro=0),this._redPro=this._greenPro,this._barset(this._redbar,this._redPro),this._barset(this._greenbar,this._greenPro)},o.barLong=function(e){this._greenPro+=e,this._greenPro>1&&(this._greenPro=1),this._beginWhiteDec(),this._whiteProGoal<this._greenPro&&(this._whiteProGoal=this._greenPro),this._whitePro<this._whiteProGoal&&(this._whitePro=this._whiteProGoal),this._barset(this._greenbar,this._greenPro),this._barset(this._whitebar,this._whitePro)},o.update=function(e){this._delaytime>0&&(this._delaytime-=e,this._delaytime<0&&this._beginWhiteDec()),this._whitePro>this._whiteProGoal&&(this._whitePro-=this.shorterSpeed*e,this._whitePro<this._whiteProGoal&&(this._whitePro=this._whiteProGoal),this._barset(this._whitebar,this._whitePro)),this._redPro<this._greenPro&&(this._redPro+=this.shorterSpeed*e/3,this._redPro>this._greenPro&&(this._redPro=this._greenPro),this._barset(this._redbar,this._redPro))},o._beginWhiteDec=function(){this._delaytime=0,this._whiteProGoal=this._greenPro},t}(d)).prototype,"maxLen",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),m=t(p.prototype,"delaytimeMax",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),y=t(p.prototype,"shorterSpeed",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2.5}}),u=p))||u));o._RF.pop()}}}));

System.register("chunks:///_virtual/itemChoose.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"926e2iMwfxLeb1Md4feV4Ua","itemChoose",void 0),t("itemChoose",function(){function t(){this.maxItemCount=5,this.typeOfItem=[],this.item=[]}t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance};var e=t.prototype;return e.typeof=function(t){return this.typeOfItem[t]},e.itemOf=function(t){return this.item[t]},e.addItem=function(t,e){return this.item.length!=this.maxItemCount&&(-1==this.indexOfItem(t,e)&&(this.typeOfItem.push(t),this.item.push(e),!0))},e.itemCounts=function(){return this.item.length},e.removeItem=function(t,e){var i=this.indexOfItem(t,e);return-1!=i&&(this.typeOfItem.splice(i,1),this.item.splice(i,1),!0)},e.indexOfItem=function(t,e){for(var i=0;i<this.item.length;i++)if(this.typeOfItem[i]==t&&this.item[i]==e)return i;return-1},t}()).instance=void 0,e._RF.pop()}}}));

System.register("chunks:///_virtual/itemSlot.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UnitsManager.ts","./UIManager.ts"],(function(t){var e,i,n,o,s,c,r,a,l,p,h,u,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){s=t.cclegacy,c=t._decorator,r=t.CCInteger,a=t.Node,l=t.Label,p=t.Sprite,h=t.Component},function(t){u=t.UnitsManager},function(t){d=t.UIManager}],execute:function(){var f,S,g,y,v;s._RF.push({},"cd835+n5DdE54pqYkjAcV9G","itemSlot",void 0);var m=c.ccclass,b=c.property;t("itemSlot",(f=m("itemSlot"),S=b(r),f((v=e((y=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))||this).sprite=void 0,e.costLabel=void 0,n(e,"type",v,o(e)),e.isSelected=void 0,e}i(e,t);var s=e.prototype;return s.start=function(){},s.onDestroy=function(){this.node.off(a.EventType.TOUCH_START)},s.onLoad=function(){this.costLabel=this.node.getChildByName("costLabel").getComponent(l),this.sprite=this.node.getComponent(p),this.node.on(a.EventType.TOUCH_START,this.touched,this),this.isSelected=!1},s.loader=function(t){switch(t){case 0:this.costLabel.string=u.instance.getPriceof(this.type).toString()}},s.touched=function(){this.isSelected?d.instance.cancelSelecteSlot(this):d.instance.selectSlot(this)},s.seletced=function(){this.isSelected=!0;var t=this.sprite.color.clone();t.a=100,this.sprite.color=t},s.cancelSelected=function(){this.isSelected=!1;var t=this.sprite.color.clone();t.a=255,this.sprite.color=t},e}(h)).prototype,"type",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),g=y))||g));s._RF.pop()}}}));

System.register("chunks:///_virtual/itemSlotUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./itemChoose.ts","./itemSlot.ts"],(function(e){var t,i,r,o,n,a,c,s,u,l,f,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized,n=e.createForOfIteratorHelperLoose},function(e){a=e.cclegacy,c=e._decorator,s=e.Prefab,u=e.instantiate,l=e.Component},function(e){f=e.itemChoose},function(e){p=e.itemSlot}],execute:function(){var m,h,d,b,P,v,y,g,I,S;a._RF.push({},"ac306uH1XBMDaUHYqe8oNYs","itemSlotUI",void 0);var z=c.ccclass,C=c.property;e("itemSlotUI",(m=z("itemSlotUI"),h=C(s),d=C(s),b=C(s),m(((S=function(e){function t(){var i;return i=e.call(this)||this,r(i,"unitPre",y,o(i)),r(i,"magicPre",g,o(i)),r(i,"techPre",I,o(i)),t.instance=o(i),i}return i(t,e),t.prototype.restartLoader=function(){for(var e,t=this.node.children,i=n(t);!(e=i()).done;){e.value.destroy()}for(var r=f.getInstance(),o=0;o<r.itemCounts();o++){var a=void 0;switch(r.typeof(o)){case 0:a=u(this.unitPre[r.itemOf(o)]);break;case 1:a=u(this.magicPre[r.itemOf(o)]);break;case 2:a=u(this.techPre[r.itemOf(o)])}a.setParent(this.node),a.getComponent(p).loader(r.typeof(o))}},t}(l)).instance=void 0,y=t((v=S).prototype,"unitPre",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),g=t(v.prototype,"magicPre",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=t(v.prototype,"techPre",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),P=v))||P));a._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./AIPlayer.ts","./UnitsManager.ts","./MathTool.ts","./AnimStateType.ts","./UnitsRenderer.ts","./damageText.ts","./hpbar.ts","./mCollider.ts","./cameraScaleButton.ts","./RestartButton.ts","./itemSlot.ts","./itemSlotUI.ts","./Bullet.ts","./basicBullet.ts","./bulletTypeInform.ts","./healBullet.ts","./TextManager.ts","./UIManager.ts","./belongingManager.ts","./bulletsManager.ts","./damageTextManager.ts","./gameManager.ts","./resourceManager.ts","./touchtest.ts","./Map.ts","./MapManager.ts","./movingBall.ts","./wMapGuider.ts","./itemChoose.ts","./Resource.ts","./ResourceTypeInform.ts","./whitePoint.ts","./CircularSpellMagician.ts","./Unit.ts","./UnitTypeInform.ts","./basicHealer.ts","./basic.ts","./core.ts","./miner.ts","./Shooter.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/Map.ts",["cc","./MathTool.ts"],(function(t){var r,n,a,o;return{setters:[function(t){r=t.cclegacy,n=t._decorator,a=t.Vec2},function(t){o=t.MathTool}],execute:function(){r._RF.push({},"5a5bdqESt9Hw4paTWnTSaAF","Map",void 0);n.ccclass,n.property;var i=t("terrain",function(t){return t[t.ground=0]="ground",t[t.water=1]="water",t[t.mountain=2]="mountain",t}({})),e=function(){function t(t){this.seed=void 0,this.seed=1e4*t}return t.prototype.random=function(){return this.seed=(1243*this.seed+3)%1e4,this.seed/1e4},t}(),h=t("Point",function(){function t(t,r){this.x=0,this.y=0,this.x=t,this.y=r}var r=t.prototype;return r.set=function(t,r){this.x=t,this.y=r},r.array=function(t){if(0==t)return this.x;if(1==t)return this.y;throw new Error("point has not the array bigger than 1!")},r.add=function(t){return this.x+=t.x,this.y+=t.y,this},r.sub=function(t){return this.x-=t.x,this.y-=t.y,this},r.Manhat=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},r.isEqual=function(t){return t.x==this.x&&t.y==this.y},t}());t("wMap",function(){function t(t,r,n,u,f){this.width=void 0,this.height=void 0,this.Array=void 0;var c=new e(f);this.width=t,this.height=r,this.Array=[];for(var l=0;l<r;l++){this.Array.push([]);for(var y=0;y<t;y++)this.Array[l].push(i.ground)}for(var d=1;d<=n.length;d++){var p=0,M=n[d-1]*t*r,v=u[d-1];if(null==v)throw new Error("map generator wrong:sizePro are empty");for(;p<M;){for(var x=new h(Math.floor(c.random()*t),Math.floor(c.random()*r));this.Array[x.y][x.x]==d;)x.set(Math.floor(c.random()*t),Math.floor(c.random()*r));for(var w=[],m=0;m<2;m++){switch(Math.floor(4*c.random())){case 0:w[m]=new a(0,1);break;case 1:w[m]=new a(0,-1);break;case 2:w[m]=new a(1,0);break;case 3:w[m]=new a(-1,0)}for(var g=new h(x.x,x.y),A=v*Math.sqrt(t*r)*(.5*c.random()+.5),b=0;b<A;b++)if(g.add(w[m]),g.x<0||g.y<0||g.x>=t||g.y>=r){g.add(w[m].clone().multiplyScalar(-1));break}for(var k=x.Manhat(g),V=new h(x.x,x.y),E=.2*c.random()-.1,P=0;P<k;P++){var S=o.Vec2Vertical(w[m],!0),T=A/4,_=Math.floor(s(P/k)*T);p+=this.fill(V,S,_+E*T,d),S=o.Vec2Vertical(w[m],!1),p+=this.fill(V,S,_-E*T,d),E+=.2*c.random()-.1,V.add(w[m])}}}}}var r=t.prototype;return r.fill=function(t,r,n,a){for(var o=0,i=new h(t.x,t.y),e=0;e<n&&(null!=this.Array[i.y]&&null!=this.Array[i.y][i.x]);e++)this.Array[i.y][i.x]!=a?(this.Array[i.y][i.x]=a,o++,i.add(r)):i.add(r);return o},r.print=function(){console.log(this.Array)},r.setmap=function(t,r,n){this.Array[r][t]=n},r.getmap=function(t,r){if(null==this.Array[Math.floor(r)])return null;var n=this.Array[Math.floor(r)][Math.floor(t)];return null==n?(console.log("get map:null??"),null):n},t}());function s(t){return t<0?0:t<.25?Math.sin(2*t*Math.PI):t<1?Math.sin((2*(t-.25)/3+.5)*Math.PI):0}r._RF.pop()}}}));

System.register("chunks:///_virtual/MapManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Map.ts","./wMapGuider.ts","./movingBall.ts","./UnitsManager.ts","./resourceManager.ts"],(function(e){var t,a,i,r,n,o,s,h,l,p,u,c,d,m,f,g,v,w,b;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,n=e.createForOfIteratorHelperLoose},function(e){o=e.cclegacy,s=e._decorator,h=e.Node,l=e.Prefab,p=e.instantiate,u=e.Vec3,c=e.Vec2,d=e.randomRange,m=e.Component},function(e){f=e.Point},function(e){g=e.wMapGuider},function(e){v=e.movingBall},function(e){w=e.UnitsManager},function(e){b=e.resourceManager}],execute:function(){var y,M,N,S,q,k,x,P,R,T,D,L,A,F;o._RF.push({},"4af738yBQFC9L2AfjZOrCXa","MapManager",void 0);var W=s.ccclass,z=s.property;e("MapManager",(y=W("MapManager"),M=z(h),N=z(l),S=z(l),q=z(l),k=z(l),y(((F=function(e){function t(){var a;return(a=e.call(this)||this).map=void 0,i(a,"theMap",R,r(a)),i(a,"ground",T,r(a)),i(a,"edge",D,r(a)),i(a,"mask",L,r(a)),i(a,"line",A,r(a)),a.blockH=30,a.blockW=30,a.blockx=0,a.blocky=0,a.mapNode=[],a.edgeNode=[],a.eachSquare=100,a.time=1,a.tmpblock=0,t.instance=r(a),a}a(t,e);var o=t.prototype;return o.onLoad=function(){var e=Date.now();this.map=new g(50,50,[.2],[.2],.1),console.log("generateTimeSpend:"+(Date.now()-e)),this.map.print(),this.map.FindJumpNode(1),this.map.LinkJumpNode(1);this.map.JumpNodes[1];console.log("FindtimeSpend:"+(Date.now()-e)),this.mapRender(),console.log("renderTImeSpent:"+(Date.now()-e))},o.Reload=function(e,t,a,i,r){if(0!=this.mapNode.length&&this.deleteMapNode(0,0,this.mapNode.length,this.mapNode[0].length),0!=this.edgeNode.length){for(var n=0;n<this.edgeNode.length;n++)this.edgeNode[n].destroy();this.edgeNode.length=0}this.map=new g(e,t,a,i,r),this.map.FindJumpNode(1),this.map.LinkJumpNode(1),this.mapRender()},o.update=function(e){this.time<0&&(this.time+=1,this.blockDisappear(Math.floor(this.tmpblock/10),this.tmpblock%10),this.tmpblock+=1,this.blockRender(Math.floor(this.tmpblock/10),this.tmpblock%10))},o.blockDisappear=function(e,t){for(var a=t*this.blockH;a<(t+1)*this.blockH;a++){if(null==this.map.Array[a])return;if(null==this.mapNode[a])throw new Error("no map to dissapear");for(var i=e*this.blockW;i<(e+1)*this.blockW&&null!=this.map.Array[a][i];i++){if(null==this.mapNode[a][i])throw new Error("no map to dissapear");this.mapNode[a][i].active=!1}}},o.blockRender=function(e,t){for(var a=t*this.blockH;a<(t+1)*this.blockH;a++){if(null==this.map.Array[a])return;null==this.mapNode[a]&&(this.mapNode[a]=[]);for(var i=e*this.blockW;i<(e+1)*this.blockW&&null!=this.map.Array[a][i];i++){if(null==this.mapNode[a][i]){var r=this.map.Array[a][i];if(null==this.ground[r])throw new Error("no terrain prefab!");var n=p(this.ground[r]);n.setParent(this.theMap),n.position=new u((.5+i)*this.eachSquare,(.5+a)*this.eachSquare,0),this.mapNode[a][i]=n}this.mapNode[a][i].active=!0}}},o.mapRender=function(){for(var e=0;e<this.map.height;e++){null==this.mapNode[e]&&(this.mapNode[e]=[]);for(var t=0;t<this.map.width;t++){var a=this.map.Array[e][t];if(null==this.ground[a])throw new Error("no terrain prefab!");var i=p(this.ground[a]);i.setParent(this.theMap),i.position=new u((.5+t)*this.eachSquare,(.5+e)*this.eachSquare,0),this.mapNode[e][t]=i,i.active=!0}}for(var r=-1;r<=this.map.height;r++){var n=p(this.edge);n.setParent(this.theMap),n.position=this.posTrans(-1,r),n.active=!0,this.edgeNode.push(n),(n=p(this.edge)).setParent(this.theMap),n.position=this.posTrans(this.map.width,r),n.active=!0,this.edgeNode.push(n)}for(var o=0;o<this.map.width;o++){var s=p(this.edge);s.setParent(this.theMap),s.position=this.posTrans(o,-1),s.active=!0,this.edgeNode.push(s),(s=p(this.edge)).setParent(this.theMap),s.position=this.posTrans(o,this.map.height),s.active=!0,this.edgeNode.push(s)}},o.posTrans=function(e,t){return new u((.5+e)*this.eachSquare,(.5+t)*this.eachSquare,0)},o.deleteMapNode=function(e,t,a,i){for(var r=e;r<a;r++){if(null==this.mapNode[r])throw new Error("no map node to delete!");for(var n=t;n<i;n++){if(null==this.mapNode[r][n])throw new Error("no map node to delete!!");this.mapNode[r][n].destroy()}}},o.JumpNodeLinkRender=function(e){if(null==this.line)throw new Error("No prefab:line in MapManager");for(var t,a=n(this.map.JumpNodes[e].values());!(t=a()).done;)for(var i,r=t.value,o=n(r.neighbors);!(i=o()).done;){var s=i.value,h=p(this.line);h.setParent(this.node),h.getComponent(v).loader(new c((.5+r.x)*this.eachSquare,(.5+r.y)*this.eachSquare),new c((.5+s.x)*this.eachSquare,(.5+s.y)*this.eachSquare),500)}},o.SearchWay=function(e,t,a){var i=new f(Math.floor(e.x/this.eachSquare),Math.floor(e.y/this.eachSquare)),r=new f(Math.floor(t.x/this.eachSquare),Math.floor(t.y/this.eachSquare)),o=this.map.searchBestWay(i,r,a);if(null==o)return null;for(var s,h=[],l=n(o);!(s=l()).done;){var p=s.value;h.push(new c((.5+p.x)*this.eachSquare,(.5+p.y)*this.eachSquare))}return 0==h.length&&(h=null),h},o.calWayLong=function(e){var t=0;if(null==e)return null;for(var a,i,r,n,o=e[0],s=1;s<e.length;s++)t+=(a=o,i=e[s],r=void 0,n=void 0,r=i.x-a.x,n=i.y-a.y,Math.sqrt(r*r+n*n)),o=e[s];return t},o.isOnGround=function(e){var t=new f(Math.floor(e.x/this.eachSquare),Math.floor(e.y/this.eachSquare));return 0==this.map.getmap(t.x,t.y)},o.randomGeneratePos=function(e){void 0===e&&(e=1);for(var t=new u(d(0,this.map.width*this.eachSquare),d(0,this.map.height*this.eachSquare));this.map.getmap(Math.floor(t.x/this.eachSquare),Math.floor(t.y/this.eachSquare))>=e;)t.x=d(0,this.map.width*this.eachSquare),t.y=d(0,this.map.height*this.eachSquare);return t},o.randomGeneratePosAwayFromCore=function(e,t){void 0===t&&(t=1);for(var a=[],i=w.instance.teamNumber-1;i>=0;i--)i!=e&&a.push(w.instance.CoreOfTeam(i));for(var r,n=!1;!n;){n=!0,r=this.randomGeneratePos(t);for(var o=0;o<a.length;o++)if(c.distance(new c(r.x,r.y),new c(a[o].node.position.x,a[o].node.position.y))<800){n=!1;break}}return r},o.randomGeneratePosToMine=function(e,t,a){var i=b.instance.randomRes(t);if(null==i)return null;for(var r=i.node.getPosition(),n=[],o=w.instance.teamNumber-1;o>=0;o--)o!=e&&n.push(w.instance.CoreOfTeam(o));for(var s=0;s<n.length;s++)if(c.distance(new c(r.x,r.y),new c(n[s].node.position.x,n[s].node.position.y))<800)return null;return r.x+=d(0,this.eachSquare/2)-this.eachSquare/4,r.y+=d(0,this.eachSquare/2)-this.eachSquare/4,r},t}(m)).instance=void 0,R=t((P=F).prototype,"theMap",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=t(P.prototype,"ground",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),D=t(P.prototype,"edge",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=t(P.prototype,"mask",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=t(P.prototype,"line",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=P))||x));o._RF.pop()}}}));

System.register("chunks:///_virtual/MathTool.ts",["cc"],(function(n){var e,t,c;return{setters:[function(n){e=n.cclegacy,t=n.randomRange,c=n.Vec2}],execute:function(){e._RF.push({},"a2c4edDXkZF75U3p84EJuwE","MathTool",void 0);n("MathTool",function(){function n(){}return n.Vec2Perpendicular=function(n){return t(-1,1)<0?new c(-n.y,n.x):new c(n.y,-n.x)},n.Ve2Rotate=function(n,e){var t=e*Math.PI/180,r=Math.cos(t),o=Math.sin(t),u=n.x*r-n.y*o,a=n.x*o+n.y*r;return new c(u,a)},n.Vec2Vertical=function(n,e){return e?new c(n.y,-n.x):new c(-n.y,n.x)},n}());e._RF.pop()}}}));

System.register("chunks:///_virtual/mCollider.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,i,o,r,l,s,c,d,a,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,s=e.CCInteger,c=e.Vec3,d=e.CCBoolean,a=e.Component,h=e.Vec2}],execute:function(){var u,p,f,g,v,w,y,C,m,x,b;r._RF.push({},"174d7W5DdRK1qRLIxPg+lMS","mCollider",void 0);var P=l.ccclass,M=l.property,_=function(){function e(){this.clds=[]}e.getInstance=function(){return e.instance||(e.instance=new e),e.instance};var t=e.prototype;return t.addNewCollider=function(e){if(null==e)throw new Error("the mCollider do not exist");-1==this.clds.indexOf(e)&&this.clds.push(e)},t.Force=function(e){var t=this;if(null==e)throw new Error("the mCollider do not exist");var n=this.clds.indexOf(e);if(-1==n)throw new Error("the mCollider do not in the Manager!");for(var i,o,r,l,s,c,d,a=null,u=0;u<this.clds.length;u++)d=void 0,d=new h(0,0),u!=n&&(i=e,o=t.clds[u],r=void 0,l=void 0,s=void 0,c=void 0,r=i.node.getPosition().clone().add(i.center),l=o.node.getPosition().clone().add(o.center),s=Math.abs(r.x-l.x)-(i.width+o.width)/2,c=Math.abs(r.y-l.y)-(i.height+o.height)/2,s<0&&c<0&&(s*c>i.width*i.height/32||s*c>o.width*o.height/32)&&((-s<i.width/8||-s<o.width/8)&&(-c<i.height/8||-c<o.height/8)?(r.y>l.y?d.y=-c/2:d.y=c/2,r.x>l.x?d.x=-s/2:d.x=s/2,!0):(s<c?r.y>l.y?d.y=-c/2:d.y=c/2:r.x>l.x?d.x=-s/2:d.x=s/2,!0)))&&(null==a&&(a=new h(0,0)),t.clds[u].canBeMoved?(t.clds[u].ForcedToMove(d.clone().multiplyScalar(-1)),a.add(d)):a.add(d.multiplyScalar(2)));return a},t.removeCollider=function(e){if(null==e)throw new Error("the mCollider do not exist");var t=this.clds.indexOf(e);-1!=t?this.clds.splice(t,1):console.log("the mCollider do not in the Manager!")},e}();_.instance=void 0;e("mCollider",(u=P("mCollider"),p=M(s),f=M(s),g=M(c),v=M(d),u((C=t((y=function(e){function t(){var t;return t=e.call(this)||this,i(t,"height",C,o(t)),i(t,"width",m,o(t)),i(t,"center",x,o(t)),i(t,"canBeMoved",b,o(t)),t._prePos=null,_.getInstance().addNewCollider(o(t)),t}n(t,e);var r=t.prototype;return r.onLoad=function(){_.getInstance().addNewCollider(this),this._prePos=null},r.onEnable=function(){_.getInstance().addNewCollider(this),this._prePos=null},r.update=function(e){if(null==this._prePos&&(this._prePos=this.node.getPosition().clone()),this.canBeMoved){var t=_.getInstance().Force(this);null!=t&&this.ForcedToMove(t)}this._prePos=this.node.getPosition().clone()},r.ForcedToMove=function(e){var t=this.node.getPosition();t.x+=e.x,t.y+=e.y,this.node.position=t,this._prePos=t.clone()},r.onDestroy=function(){_.getInstance().removeCollider(this)},r.onDisable=function(){_.getInstance().removeCollider(this)},t}(a)).prototype,"height",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),m=t(y.prototype,"width",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),x=t(y.prototype,"center",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(0,0,0)}}),b=t(y.prototype,"canBeMoved",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),w=y))||w));r._RF.pop()}}}));

System.register("chunks:///_virtual/miner.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Unit.ts","./UnitTypeInform.ts","./resourceManager.ts","./MapManager.ts","./MathTool.ts","./basic.ts","./AnimStateType.ts"],(function(t){var e,n,i,a,r,s,o,c,h,u,m,f,p,l;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,a=t.Vec2,r=t.randomRange},function(t){s=t.UnitState,o=t.Unit},function(t){c=t.UnitType,h=t.UnitTypeInform},function(t){u=t.resourceManager},function(t){m=t.MapManager},function(t){f=t.MathTool},function(t){p=t.basicStateFreeze},function(t){l=t.AnimStateType}],execute:function(){var d;n._RF.push({},"96f14B9JP1OEJG2cSn9p2Nt","miner",void 0);var g=i.ccclass,R=(i.property,t("miner",g("miner")(d=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.AddPriceMapAndPrefrenceMapInUnitManager=function(){throw new Error("Method not implemented.")},i.setMyType=function(){this.type=c.miner},i.attack=function(){throw new Error("Method not implemented.")},i.loader=function(){this.maxhp=10,this.strength=1,this.searchRange=800,this.attackRange=100,this.attackInterval=1,this.mineRate=1,this.chaseRange=99999,this.statereg(s.Idle,new R),this.statereg(s.Chase,new y),this.statereg(s.Circling,new v),this.statereg(s.PreAttack,new _),this.statereg(s.Attack,new T),this.statereg(s.Freeze,new p),t.prototype.loader.call(this)},i.onLoad=function(){this.node.getComponent(h).Unit=this},i.update=function(t){this.UnitUpdate(t)},n}(o))||d),t("minerStateIdle",function(){function t(){this.state=s.Idle,this._time=0}var e=t.prototype;return e.StateEnter=function(t){this._time=t.responseTime*t.actionRepeat,t.anim.play(l.Idle)},e.update=function(t,e){this._time-=e,this._time<0&&(this._time=t.responseTime*t.actionRepeat,this.searchRes(t))},e.searchRes=function(t){var e=u.instance.FindLatestRes(t.node.getPosition(),[0]);null!=e&&(t.targetRes=e,e.addMiner(t),t.stateTransform(s.Chase))},t}())),y=t("minerStateChase",function(){function t(){this.state=s.Chase,this._dir=null,this._time=0}var e=t.prototype;return e.StateEnter=function(t){this.directionConfirm(t),this.detect(t)&&this.ResInReach(t)&&t.stateTransform(s.Circling),t.anim.play(l.Move)},e.update=function(t,e){this._time-=e,t.move(e,this._dir),this._time<0&&(this.detect(t)?this.ResInReach(t)?t.stateTransform(s.Circling):this.directionConfirm(t):t.stateTransform(s.Idle))},e.ResInReach=function(t){return a.distance(t.targetRes.node.getPosition(),t.node.getPosition())<=t.attackRange},e.directionConfirm=function(t){var e=Math.PI*r(-t.moveOffsetAngle,t.moveOffsetAngle)/180,n=m.instance.SearchWay(t.node.position,t.targetRes.node.position,1);if(null==n)return t.giveUpRes(),void t.stateTransform(s.Idle);var i=n[1].subtract(new a(t.node.position.x,t.node.position.y));this._dir=f.Ve2Rotate(new a(i.x,i.y),e).normalize(),this._time=t.responseTime},e.detect=function(t){return null!=t.targetRes},t}()),v=t("minerStateCircle",function(){function t(){this.state=s.Circling}var e=t.prototype;return e.StateEnter=function(t){t.anim.play(l.Idle)},e.update=function(t,e){null!=t.targetRes?t.attackReady()?t.stateTransform(s.PreAttack):this.circlemove(t,e):t.stateTransform(s.Idle)},e.circlemove=function(t,e){},t}()),_=t("minerStatePreAttack",function(){function t(){this.state=s.PreAttack,this._time=0}var e=t.prototype;return e.StateEnter=function(t){this._time=t.targetRes.collectTime/t.mineRate,t.turnTo(t.targetRes.node.getPosition().subtract(t.node.getPosition()).x),t.anim.play(l.PreAttack)},e.update=function(t,e){this._time-=e,this._time<0&&t.stateTransform(s.Attack)},t}()),T=t("minerStateAttack",function(){function t(){this._time=void 0,this.state=s.Attack,this.attackTime=0}var e=t.prototype;return e.StateEnter=function(t){null!=t.targetRes?(t.targetRes.hurt(1,t.team),t._attackcooldown=t.attackInterval,this._time=t.attackRecover):this._time=0},e.update=function(t,e){this._time>0?this._time-=e:t.stateTransform(s.Circling)},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/movingBall.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,o,s,n,e,r;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,s=t._decorator,n=t.Vec3,e=t.Vec2,r=t.Component}],execute:function(){var h;o._RF.push({},"36247lkcApLTqHlK18TDlP5","movingBall",void 0);var c=s.ccclass;s.property,t("movingBall",c("movingBall")(h=function(t){function o(){for(var i,o=arguments.length,s=new Array(o),n=0;n<o;n++)s[n]=arguments[n];return(i=t.call.apply(t,[this].concat(s))||this).from=new e(0,0),i.to=new e(100,0),i.isgo=!0,i.dir=void 0,i.speed=100,i}i(o,t);var s=o.prototype;return s.loader=function(t,i,o){this.node.position=new n(t.x,t.y),this.from=t,this.to=i,this.isgo=!0,this.dir=i.clone().subtract(t).normalize(),this.speed=o},s.onLoad=function(){},s.update=function(t){var i=new n(this.dir.x*this.speed*t,this.dir.y*this.speed*t,0);i.add(this.node.getPosition()),this.node.position=i,this.isgo?this.isReach(this.to)&&this.turn():this.isReach(this.from)&&this.turn()},s.isReach=function(t){return new e(this.node.getPosition().x,this.node.getPosition().y).subtract(t).length()<.1*this.speed},s.turn=function(){this.dir.multiplyScalar(-1),this.isgo?this.isgo=!1:this.isgo=!0},o}(r))||h);o._RF.pop()}}}));

System.register("chunks:///_virtual/Resource.ts",["./rollupPluginModLoBabelHelpers.js","cc","./hpbar.ts","./resourceManager.ts","./belongingManager.ts","./TextManager.ts"],(function(e){var t,n,i,r,s,o,a,c,h,l,u,p;return{setters:[function(e){t=e.inheritsLoose,n=e.createForOfIteratorHelperLoose},function(e){i=e.cclegacy,r=e._decorator,s=e.Sprite,o=e.Vec2,a=e.Color,c=e.Component},function(e){h=e.hpbar},function(e){l=e.resourceManager},function(e){u=e.belongingManager},function(e){p=e.TextManager}],execute:function(){var f;i._RF.push({},"38e9b0dM3ZP+5oZp2ne00Tf","Resource",void 0);var m=r.ccclass;r.property,e("Resource",m("Resource")(f=function(e){function i(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).type=void 0,t.numAll=void 0,t.numleft=void 0,t.collectTime=void 0,t.miners=void 0,t.sprite=void 0,t.resBar=void 0,t}t(i,e);var r=i.prototype;return r.loader=function(e){this.miners=[],this.sprite=this.node.getChildByName("sprite").getComponent(s),this.resBar=this.node.getChildByName("resBar").getComponent(h),this.setMyType(),this.numAll=e,this.numleft=e},r.hurt=function(e,t){this.numleft-e<0&&(e=this.numleft),this.numleft-=e,u.instance.addRes(t,this.type,e),p.instance.generateText(new o(0,0),e,this.node.position,a.YELLOW),this.resBar.barShort(e/this.numAll),this.numleft<=0&&this.death()},r.death=function(){this.escapeFromMinerAll(),l.instance.ResDeath(this)},r.addMiner=function(e){this.miners.push(e)},r.escapeFromMiner=function(e){var t=this.miners.indexOf(e);if(-1==t)throw new Error("no miner in list!");this.miners.splice(t,1),e.loseRes(this)},r.escapeFromMinerAll=function(){for(var e,t=this.miners.slice(),i=n(t);!(e=i()).done;){e.value.loseRes(this)}this.miners.length=0},i}(c))||f);i._RF.pop()}}}));

System.register("chunks:///_virtual/resourceManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResourceTypeInform.ts","./MapManager.ts","./belongingManager.ts"],(function(e){var t,r,n,s,i,o,a,u,l,h,c,p,f,d,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,s=e.assertThisInitialized,i=e.createForOfIteratorHelperLoose},function(e){o=e.cclegacy,a=e._decorator,u=e.Prefab,l=e.Node,h=e.instantiate,c=e.randomRange,p=e.Component},function(e){f=e.ResourceTypeInform},function(e){d=e.MapManager},function(e){y=e.belongingManager}],execute:function(){var g,v,x,E,M,b,R,m;o._RF.push({},"ad3b0AJ7PNIHaiKIhx6wzmW","resourceManager",void 0);var w=a.ccclass,P=a.property;e("resourceManager",(g=w("resourceManager"),v=P(u),x=P(l),g(((m=function(e){function t(){var r;return r=e.call(this)||this,n(r,"resPrefabs",b,s(r)),n(r,"resFather",R,s(r)),r.types={},r.resExist={},t.instance=s(r),r}r(t,e);var o=t.prototype;return o.CreateRes=function(e,t){var r=null,n=this.resPrefabs[e];if(null==n)throw new Error("no such a resPrefab:"+e);if(e in this.types||(this.types[e]=[]),0==this.types[e].length){var s=h(n);s.setParent(this.resFather),r=s.getComponent(f).resource}else(r=this.types[e].pop()).node.active=!0;return e in this.resExist||(this.resExist[e]=[]),this.resExist[e].push(r),r.loader(t),r},o.ResDeath=function(e){var t=this.resExist[e.type].indexOf(e);if(-1==t)throw new Error("no res in the ResExist!");this.resExist[e.type].splice(t,1),this.types[e.type].push(e),e.node.active=!1},o.RestartLoad=function(){for(var e=0;e<y.ResNum;e++)if(null!=this.resExist[e]&&this.resExist[e].length>0){for(var t,r=this.resExist[e].slice(),n=i(r);!(t=n()).done;){var s=t.value;this.ResDeath(s)}this.resExist[e].length=0}},o.FindLatestRes=function(e,t,r){void 0===r&&(r=1);for(var n=null,s=null,o=0;o<t.length;o++)if(null!=this.resExist[o])for(var a,u=i(this.resExist[o]);!(a=u()).done;){var l=a.value;if(null==s){if(null==d.instance.SearchWay(e,l.node.position,r))continue;n=l,s=Math.sqrt(Math.pow(n.node.position.x-e.x,2)+Math.pow(n.node.position.y-e.y,2))}else{var h=Math.sqrt(Math.pow(l.node.position.x-e.x,2)+Math.pow(l.node.position.y-e.y,2));if(h<s){if(null==d.instance.SearchWay(e,l.node.position,r))continue;n=l,s=h}}}return n},o.randomRes=function(e){if(null==this.resExist[e])return null;var t=Math.floor(c(0,this.resExist[e].length));return this.resExist[e][t]},t}(p)).instance=void 0,b=t((M=m).prototype,"resPrefabs",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=t(M.prototype,"resFather",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=M))||E));o._RF.pop()}}}));

System.register("chunks:///_virtual/ResourceTypeInform.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,o,n,t;return{setters:[function(e){r=e.inheritsLoose},function(e){o=e.cclegacy,n=e._decorator,t=e.Component}],execute:function(){var c;o._RF.push({},"ce837r0l0hGWpGWl2S+lElj","ResourceTypeInform",void 0);var u=n.ccclass;n.property,e("ResourceType",function(e){return e[e.whitePoint=0]="whitePoint",e}({})),e("ResourceTypeInform",u("ResourceTypeInform")(c=function(e){function o(){for(var r,o=arguments.length,n=new Array(o),t=0;t<o;t++)n[t]=arguments[t];return(r=e.call.apply(e,[this].concat(n))||this).resource=void 0,r}return r(o,e),o}(t))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/RestartButton.ts",["./rollupPluginModLoBabelHelpers.js","cc","./gameManager.ts"],(function(t){var n,e,o,r,s,a;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,r=t.Node,s=t.Component},function(t){a=t.gameManager}],execute:function(){var i;e._RF.push({},"d4fc1KdS0BJFKPA2h2vat5s","RestartButton",void 0);var c=o.ccclass;o.property,t("RestartButton",c("RestartButton")(i=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var o=e.prototype;return o.onEnable=function(){this.node.on(r.EventType.TOUCH_START,this.restart,this)},o.onDisable=function(){this.node.on(r.EventType.TOUCH_START,this.restart,this)},o.onLoad=function(){this.node.active=!1},o.restart=function(){a.instance.onGameStart(),this.node.active=!1},e}(s))||i);e._RF.pop()}}}));

System.register("chunks:///_virtual/Shooter.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Unit.ts","./UnitTypeInform.ts","./basic.ts","./bulletsManager.ts","./AnimStateType.ts","./bulletTypeInform.ts"],(function(t){var e,n,i,a,s,r,o,c,h,u,l,p,f,g,d,y,m;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,a=t.Vec2},function(t){s=t.UnitState,r=t.Unit},function(t){o=t.UnitType,c=t.UnitTypeInform},function(t){h=t.basicStateIdle,u=t.basicStateWonder,l=t.basicStateChase,p=t.basicStatePreAttack,f=t.basicStateFreeze,g=t.basicStateCircle},function(t){d=t.bulletsManager},function(t){y=t.AnimStateType},function(t){m=t.BulletType}],execute:function(){var S;n._RF.push({},"0fc19qESlZElLJOKKIQOjqL","Shooter",void 0);var k=i.ccclass,b=(i.property,t("Shooter",k("Shooter")(S=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.AddPriceMapAndPrefrenceMapInUnitManager=function(){throw new Error("Method not implemented.")},i.setMyType=function(){this.type=o.shooter},i.attack=function(){var t=this.target.node.getPosition().subtract(this.node.getPosition());this.move(0,new a(t.x,t.y));var e=d.instance.CreateBullet(this,this.target,m.basicBullet,200);this.target.hurtexpect(this.strength),e.node.position=this.node.getPosition()},i.loader=function(){this.maxhp=20,this.strength=2,this.searchRange=800,this.attackRange=300,this.attackInterval=3,this.attackPrepare=.25,this.chaseRange=2e3,this.statereg(s.Idle,new h),this.statereg(s.Wonder,new u),this.statereg(s.Chase,new l),this.statereg(s.Circling,new b),this.statereg(s.PreAttack,new p),this.statereg(s.Attack,new v),this.statereg(s.Freeze,new f),t.prototype.loader.call(this)},i.start=function(){},i.onLoad=function(){this.node.getComponent(c).Unit=this},i.update=function(t){this.UnitUpdate(t)},n}(r))||S),function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.StateEnter=function(t){t.anim.play(y.Idle)},n}(g)),v=t("shooterStateAttack",function(){function t(){this.state=s.Attack,this._time=0}var e=t.prototype;return e.StateEnter=function(t){null!=t.target?(t.attack(),t._attackcooldown=t.attackInterval,this._time=t.attackRecover):this._time=0},e.update=function(t,e){this._time>0?this._time-=e:t.stateTransform(s.Circling)},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/TextManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,o;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e._decorator,o=e.Component}],execute:function(){var a,c;n._RF.push({},"251a9NCIWpDkry8+WRHy+yo","TextManager",void 0);var i=r.ccclass;r.property,e("TextManager",i("TextManager")(((c=function(e){function n(){return e.apply(this,arguments)||this}return t(n,e),n}(o)).instance=void 0,a=c))||a);n._RF.pop()}}}));

System.register("chunks:///_virtual/touchtest.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIManager.ts"],(function(t){var e,n,o,i,r,a,c,s,u,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,c=t.CCInteger,s=t.Node,u=t.Component},function(t){p=t.UIManager}],execute:function(){var l,h,f,y,d,g,v;r._RF.push({},"7ad28pGj4RICraq0reB0YdH","touchtest",void 0);var T=a.ccclass,m=a.property;t("touchtest",(l=T("touchtest"),h=m(c),f=m(c),l((g=e((d=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,o(e,"team",g,i(e)),o(e,"type",v,i(e)),e}n(e,t);var r=e.prototype;return r.start=function(){},r.onLoad=function(){this.node.on(s.EventType.TOUCH_START,this.touched,this)},r.onDestroy=function(){this.node.off(s.EventType.TOUCH_START)},r.update=function(t){},r.touched=function(){p.instance.team=this.team,p.instance.type=this.type},e}(u)).prototype,"team",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=e(d.prototype,"type",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=d))||y));r._RF.pop()}}}));

System.register("chunks:///_virtual/UIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./gameManager.ts","./itemSlotUI.ts"],(function(e){var t,i,a,n,o,s,r,c,h,l,m,u,d,g,p,_,f,w;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,a=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,s=e._decorator,r=e.CCInteger,c=e.input,h=e.Input,l=e.UITransform,m=e.Camera,u=e.screen,d=e.Vec3,g=e.Vec2,p=e.Size,_=e.Component},function(e){f=e.gameManager},function(e){w=e.itemSlotUI}],execute:function(){var S,z,v,y,U,R,I,C,T,b;o._RF.push({},"f82a3ZwOYlINqw/1QSZbws2","UIManager",void 0);var L=s.ccclass,H=s.property;e("UIManager",(S=L("UIManager"),z=H(r),v=H(r),y=H(r),S(((b=function(e){function t(){var i;return i=e.call(this)||this,a(i,"size",I,n(i)),a(i,"team",C,n(i)),a(i,"type",T,n(i)),i._camera=void 0,i.designSize=void 0,i._nowSize=void 0,i._cameraRate=void 0,i._cameraOriginHeight=void 0,i._isCameramoving=void 0,i.selectedSlot=null,t.instance=n(i),i.team=0,i.type=null,i._cameraRate=1,i}i(t,e);var o=t.prototype;return o.onLoad=function(){c.on(h.EventType.TOUCH_START,this.touched,this),c.on(h.EventType.TOUCH_MOVE,this.moved,this),c.on(h.EventType.TOUCH_END,this.ended,this),this._camera=this.node.getParent(),this.designSize=this._camera.getParent().getComponent(l).contentSize,this._nowSize=this.designSize.clone(),this._cameraOriginHeight=this._camera.getComponent(m).orthoHeight,this.size=u.windowSize,this.cameraUpdate(),u.on("window-resize",this.onWindowResize,this)},o.restartLoader=function(){this.type=null,w.instance.restartLoader()},o.start=function(){},o.update=function(e){},o.tst=function(){console.log("touchend")},o.moved=function(e){if(null==this._camera)throw new Error("no camera");if(0==this._isCameramoving){if(e.getUILocation().subtract(e.getUIStartLocation()).length()>10){this._isCameramoving=!0;var t=e.getUILocation().subtract(e.getUIStartLocation()),i=new d(t.x,t.y,0);this._camera.position=this._camera.position.subtract(i)}}else{var a=new d(e.getUIDelta().x*this._cameraRate,e.getUIDelta().y*this._cameraRate,0);this._camera.position=this._camera.position.subtract(a)}},o.touched=function(e){this._isCameramoving=!1},o.ended=function(e){if(!this._isCameramoving&&null!=this.type){var t=this.TouchPosToLocal(e.getLocation()),i=new d(t.x+this._camera.position.x,t.y+this._camera.position.y,0);f.instance.tryToPutUnit(i,this.type,this.team,this._cameraRate)}},o.TouchPosToLocal=function(e){return console.log(e),new g(640+this._nowSize.width*(e.x/this.size.width-.5),640+this._nowSize.height*(e.y/this.size.height-.5))},o.cameraHigher=function(){this._cameraRate+=.2,this.cameraUpdate()},o.cameraLower=function(){this._cameraRate<.3||(this._cameraRate-=.2,this.cameraUpdate())},o.moveCameraTo=function(e){var t=new d(e.x-this.designSize.width/2,e.y-this.designSize.width/2,this._camera.position.z);this._camera.position=t,console.log(e)},o.selectSlot=function(e){null!=this.selectedSlot&&this.selectedSlot.cancelSelected(),this.selectedSlot=e,e.seletced(),this.type=e.type},o.cancelSelecteSlot=function(e){if(this.selectedSlot!=e)throw new Error("cancel select failed! not match!");this.selectedSlot=null,e.cancelSelected(),this.type=null},o.cameraUpdate=function(){this._nowSize=new p(this.designSize.width*this._cameraRate,this.designSize.height*this._cameraRate),this._camera.getComponent(m).orthoHeight=this._cameraOriginHeight*this._cameraRate,this.node.scale=new d(this._cameraRate,this._cameraRate,1)},o.onWindowResize=function(e,t){this.size=new p(e,t)},t}(_)).instance=void 0,I=t((R=b).prototype,"size",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=t(R.prototype,"team",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=t(R.prototype,"type",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=R))||U));o._RF.pop()}}}));

System.register("chunks:///_virtual/Unit.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UnitsManager.ts","./damageTextManager.ts","./hpbar.ts","./MapManager.ts","./AnimStateType.ts","./TextManager.ts"],(function(t){var e,i,n,a,r,s,o,h,l,c,u,p,g,d,m,f,b,y,v,R;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized,r=t.createForOfIteratorHelperLoose},function(t){s=t.cclegacy,o=t._decorator,h=t.CCInteger,l=t.CCFloat,c=t.Vec2,u=t.Animation,p=t.Vec3,g=t.Sprite,d=t.Color,m=t.Component},function(t){f=t.UnitsManager},null,function(t){b=t.hpbar},function(t){y=t.MapManager},function(t){v=t.AnimStateType},function(t){R=t.TextManager}],execute:function(){var w,x,C,T,k,_,F,P,z,S,I,A,M,U,E,N,L,D,G,W,B,H,O,V,j,Y,q,J,K,Q,X,Z;s._RF.push({},"66f38xnOMhANItY08kFAETb","Unit",void 0);var $=o.ccclass,tt=o.property,et=t("UnitState",function(t){return t[t.Idle=0]="Idle",t[t.Wonder=1]="Wonder",t[t.Chase=2]="Chase",t[t.Attack=3]="Attack",t[t.Freeze=4]="Freeze",t[t.Circling=5]="Circling",t[t.PreAttack=6]="PreAttack",t[t.ReturnToGuard=7]="ReturnToGuard",t}({}));t("Unit",(w=$("Unit"),x=tt(h),C=tt(h),T=tt(h),k=tt(h),_=tt(h),F=tt(h),P=tt(h),z=tt(h),S=tt(h),I=tt(h),A=tt(h),M=tt(h),U=tt(h),E=tt(l),w(((Z=function(t){function e(){var i;return(i=t.call(this)||this).states={},i.currentState=void 0,i.hpbar=null,i.type=void 0,n(i,"sibling",D,a(i)),n(i,"team",G,a(i)),n(i,"maxhp",W,a(i)),n(i,"mp",B,a(i)),n(i,"strength",H,a(i)),n(i,"spellPower",O,a(i)),n(i,"armor",V,a(i)),n(i,"magicResistance",j,a(i)),n(i,"searchRange",Y,a(i)),i.chaseRange=void 0,n(i,"attackRange",q,a(i)),n(i,"basicSpeed",J,a(i)),n(i,"attackInterval",K,a(i)),n(i,"attackPrepare",Q,a(i)),n(i,"responseTime",X,a(i)),i.attackRecover=.3,i.hp=void 0,i.hpexpect=void 0,i.guard=void 0,i.guardRange=void 0,i.actionRepeat=3,i.sprite=void 0,i.characterNode=void 0,i.anim=void 0,i.isFaceRight=void 0,i.target=void 0,i.chasers=[],i.targetRes=null,i.mineRate=1,i.testid=void 0,i.Speed=void 0,i.moveDir=void 0,i.moveOffsetAngle=30,i._attackcooldown=void 0,i._time=void 0,i._maxtime=void 0,i._hurttime=void 0,i._originColor=void 0,i._delaydeathTime=0,i.testid=e.allid++,i}i(e,t);var s=e.prototype;return s.isMaxHp=function(){return this.hp==this.maxhp},s.isFarFromGuard=function(){if(null!=this.guard){var t=this.node.getPosition();if(null==this.guard.node)return!1;var e=this.guard.node.getPosition();t.subtract(e);return this.node.getPosition().subtract(this.guard.node.getPosition()).length()>this.guardRange}throw new Error("no guard Unit!")},s.ToGuardV2=function(){var t=y.instance.SearchWay(this.node.position,this.guard.node.position,1);return null==t?null:t[1].subtract(new c(this.node.position.x,this.node.position.y)).normalize()},s.stopGuard=function(){this.guard=null},s.hasGuard=function(){return null!=this.guard},s.hastarget=function(){return null!=this.target},s.gettarget=function(){return this.target},s.attackReady=function(){return this._attackcooldown<=0},s.move=function(t,e,i){e.x<0&&this.isFaceRight?(this.characterNode.getComponent(u).play("turnLeft"),this.isFaceRight=!1):e.x>=0&&0==this.isFaceRight&&(this.isFaceRight=!0,this.characterNode.getComponent(u).play("turnRight"));var n=this.node.getPosition();this.node.position=new p(n.x+e.x*t*this.Speed,n.y+e.y*t*this.Speed,n.z)},s.turnTo=function(t){t<0&&this.isFaceRight?(this.characterNode.getComponent(u).play("turnLeft"),this.isFaceRight=!1):t>=0&&0==this.isFaceRight&&(this.isFaceRight=!0,this.characterNode.getComponent(u).play("turnRight"))},s.targetInChaseReach=function(){if(null==this.target)throw new Error("in Target In Chase Reach:no target");var t=y.instance.SearchWay(this.node.position,this.target.node.position,1);return!(null==y.instance.calWayLong(t)||y.instance.calWayLong(t)>this.chaseRange)},s.targetInReach=function(){if(null==this.target)throw new Error("in Target In Reach:no target");return c.distance(this.target.node.getPosition(),this.node.getPosition())<=this.attackRange},s.loader=function(){if(this._hurttime=0,this._time=0,this._attackcooldown=0,this.target=null,this.guard=null,this.characterNode=this.node.getChildByName("character"),this.sprite=this.characterNode.getChildByName("sprite").getComponent(g),this.anim=this.characterNode.getChildByName("sprite").getComponent(u),this.isFaceRight=!0,this.anim.pause(),this.anim.play("Idle"),null==this.sprite)throw new Error("loader in Unit dont have sprite");0!=this.team?this.sprite.color=new d(255,150,150,255):this.sprite.color=new d(255,255,255,255),this._originColor=this.sprite.color.clone(),this.setMyType(),this.stateTransform(et.Idle),this.Speed=this.basicSpeed,this.hp=this.maxhp,this.hpexpect=this.hp,this.hpbar=this.node.getComponentInChildren(b),this.hpbar.setBar(1)},s.searchEnemy=function(){var t=f.instance.FindLatestEnemy(this);return!(null==t||c.distance(t.node.getPosition(),this.node.getPosition())>=this.searchRange)&&(this.target=t,this.targetInChaseReach()?(this.target=t,this.target.chasers.push(this),!0):(this.target=null,!1))},s.hurtexpect=function(t){this.hpexpect-=t,this.hpexpect<=0&&this.escapeFromChasingAll()},s.delayDeath=function(t){this._delaydeathTime=t},s.hurt=function(t,i){if(null==i||null==i.node)R.instance.generateText(new c(0,0),t,this.node.position,d.RED);else{var n=this.node.getPosition().subtract(i.node.getPosition());R.instance.generateText(new c(n.x,n.y),t,this.node.position,d.RED)}this._hurttime=e.hurttimeMax,this.hp-=t,this.hpbar.barShort(1*t/this.maxhp),this.hp<=0&&this.death()},s.healexpect=function(t){this.hpexpect+=t,this.hpexpect>this.maxhp&&(this.hpexpect=this.maxhp)},s.heal=function(t,e){if(null==e||null==e.node)R.instance.generateTextHeal(t,this.node.position);else{this.node.getPosition().subtract(e.node.getPosition());R.instance.generateTextHeal(t,this.node.position)}this.hp+=t,this.hp>this.maxhp&&(this.hp=this.maxhp),this.hpbar.barLong(1*t/this.maxhp)},s.death=function(){this.hastarget()&&this.giveupTarget(),this.escapeFromChasingAll(),this.giveUpRes(),f.instance.UnitDead(this)},s.giveUpRes=function(){null!=this.targetRes?this.targetRes.escapeFromMiner(this):console.log("!!!!!!no targetRes of Unit:"+this.name)},s.loseRes=function(t){if(this.targetRes!=t)throw new Error("not the correct res");this.targetRes=null},s.escapeFromChasing=function(t){var e=this.chasers.indexOf(t);if(!(e>-1))throw new Error("No Such a Chaser!");this.chasers.splice(e,1),t.losetarget(this)},s.losetarget=function(t){if(void 0===t&&(t=null),t!=this.target)throw new Error("lose target are something wrong!in"+this.name);this.target=null},s.giveupTarget=function(){null!=this.target&&this.target.escapeFromChasing(this)},s.escapeFromChasingAll=function(){for(var t,e=r(this.chasers);!(t=e()).done;){t.value.losetarget(this)}this.chasers.length=0},s.stateTransform=function(t){switch(this.currentState=t,t){case et.PreAttack:this.anim.play(v.PreAttack);break;case et.Attack:this.anim.play(v.Attack);break;case et.Idle:this.anim.play(v.Idle);break;case et.Chase:case et.Circling:case et.ReturnToGuard:case et.Wonder:this.anim.play(v.Move);break;case et.Freeze:this.anim.pause()}this.states[t].StateEnter(this)},s.statereg=function(t,e){this.states[t]=e},s.UnitUpdate=function(t){if(this._delaydeathTime>0&&(this._delaydeathTime-=t,this._delaydeathTime<=0&&this.hurt(this.hp,null)),this._attackcooldown>0&&(this._attackcooldown-=t),this._hurttime>0){this._hurttime-=t,this._hurttime<0&&(this._hurttime=0);var i=this._originColor,n=1-this._hurttime/e.hurttimeMax;this.sprite.color=new d(i.r*n,i.g*n,i.b*n,255)}this.sibling=this.node.getSiblingIndex(),this.states[this.currentState].update(this,t)},s.stateAct=function(t){},e}(m)).allid=0,Z.hurttimeMax=.5,D=e((L=Z).prototype,"sibling",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=e(L.prototype,"team",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=e(L.prototype,"maxhp",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=e(L.prototype,"mp",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=e(L.prototype,"strength",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=e(L.prototype,"spellPower",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=e(L.prototype,"armor",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=e(L.prototype,"magicResistance",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=e(L.prototype,"searchRange",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=e(L.prototype,"attackRange",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=e(L.prototype,"basicSpeed",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),K=e(L.prototype,"attackInterval",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Q=e(L.prototype,"attackPrepare",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),X=e(L.prototype,"responseTime",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),N=L))||N));s._RF.pop()}}}));

System.register("chunks:///_virtual/UnitsManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Unit.ts","./UnitTypeInform.ts","./gameManager.ts"],(function(e){var t,n,i,r,o,a,s,c,u,l,f,p,h,d,m,v,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.createForOfIteratorHelperLoose},function(e){a=e.cclegacy,s=e.math,c=e._decorator,u=e.Prefab,l=e.Node,f=e.instantiate,p=e.randomRange,h=e.Component},function(e){d=e.UnitState},function(t){m=t.UnitType,v=t.UnitTypeInform,e("UnitType",t.UnitType)},function(e){g=e.gameManager}],execute:function(){var P,y,b,M,U,w,x,C,N,T;a._RF.push({},"7399bgNQvxIv755LWO9TZ/l","UnitsManager",void 0);var O=s.Vec2,D=c.ccclass,F=c.property;e("UnitPrefrence",function(e){return e[e.eco=0]="eco",e[e.defence=1]="defence",e[e.offensive=2]="offensive",e}({})),e("UnitsManager",(P=D("UnitsManager"),y=F(u),b=F(u),M=F(l),P(((T=function(e){function t(){var n;n=e.call(this)||this,i(n,"basic",x,r(n)),i(n,"unitPrefabs",C,r(n)),i(n,"units",N,r(n)),n.types={},n.camp=void 0,n.core=void 0,n.teamNumber=void 0,n.PrefrenceMap=new Map([[m.basic,[1,2]],[m.shooter,[1,2]],[m.CircularSpellMagician,[1]],[m.healer,[1]],[m.miner,[0]]]),n.PriceMap=new Map([[m.basic,2],[m.shooter,3],[m.CircularSpellMagician,10],[m.healer,2],[m.miner,2]]),n.camp=[],n.core=[],n.teamNumber=2;for(var o=0;o<n.teamNumber;o++)n.camp.push([]),n.core[o]=null;return t.instance=r(n),n}n(t,e);var a=t.prototype;return a.StartGame=function(){for(var e=0;e<this.teamNumber;e++){if(0!=this.camp[e].length)for(var t,n=this.camp[e].slice(),i=o(n);!(t=i()).done;){var r=t.value;if(r==this.core[e]){var a=this.camp[e].indexOf(r);if(!(a>-1))throw new Error("No core to delete in startGame()!");this.camp[e].splice(a,1),r.node.destroy()}else this.UnitDead(r)}this.core[e]=null}},a.CreateUnit=function(e,t){if(null==this.core[t]&&e!=m.core)return null;var n=null,i=this.unitPrefabs[e];if(null==i)throw new Error("no such a unit:"+e);if(e in this.types||(this.types[e]=[]),0==this.types[e].length){var r=f(i);r.setParent(this.units),n=r.getComponent(v).Unit}else(n=this.types[e].pop()).node.active=!0;return n.team=t,this.camp[t].push(n),n.loader(),n},a.CreateCore=function(e){var t;return t=this.CreateUnit(m.core,e),this.core[e]=t,t},a.CoreOfTeam=function(e){return this.core[e]},a.getCorePos=function(e){return null==this.core[e]?null:this.core[e].node.getPosition()},a.CoreDestroyed=function(e){for(var t,n=this.camp[e].slice(),i=o(n);!(t=i()).done;){var r=t.value;r.hpexpect<=0||(r.hurtexpect(r.hp),r.delayDeath(p(0,2)),r.stateTransform(d.Freeze))}var a=this.camp[e].indexOf(this.core[e]);if(!(a>-1))throw new Error("CoreDestroy:no core!");this.camp[e].splice(a,1),this.core[e].node.destroy(),this.core[e]=null;for(var s,c=0,u=o(this.core);!(s=u()).done;){null!=s.value&&(c+=1)}c<=1&&g.instance.gameOver()},a.FindLatestEnemy=function(e){for(var t=null,n=null,i=0;i<this.teamNumber;i++)if(i!=e.team)for(var r,a=o(this.camp[i]);!(r=a()).done;){var s=r.value;if(!(s.hpexpect<=0))if(null==n)t=s,n=O.distance(s.node.getPosition(),e.node.getPosition());else{var c=O.distance(s.node.getPosition(),e.node.getPosition());c<n&&(t=s,n=c)}}return t},a.getPriceof=function(e){return this.PriceMap.get(e)},a.getPrefrenceOf=function(e){return this.PrefrenceMap.get(e)},a.getUnitTypeInPrefrence=function(e){for(var t,n=[],i=o(this.PrefrenceMap.keys());!(t=i()).done;){var r=t.value;-1!=this.PrefrenceMap.get(r).indexOf(e)&&n.push(r)}return n[Math.floor(p(0,n.length))]},a.FindEnemyInRange=function(e,t){for(var n=[],i=0;i<this.teamNumber;i++)if(i!=e.team)for(var r,a=o(this.camp[i]);!(r=a()).done;){var s=r.value;if(!(s.hpexpect<=0))O.distance(s.node.getPosition(),e.node.getPosition())<=t&&n.push(s)}return 0==n.length&&(n=null),n},a.FindLastestMate=function(e){for(var t,n=null,i=null,r=o(this.camp[e.team]);!(t=r()).done;){var a=t.value;if(!(a.hpexpect<=0||a==e))if(null==i)n=a,i=O.distance(a.node.getPosition(),e.node.getPosition());else{var s=O.distance(a.node.getPosition(),e.node.getPosition());s<i&&(n=a,i=s)}}return n},a.FindLatestHurtMate=function(e){for(var t,n=null,i=null,r=o(this.camp[e.team]);!(t=r()).done;){var a=t.value;if(!(a.hpexpect<=0||a.isMaxHp()||a==e))if(null==i)n=a,i=O.distance(a.node.getPosition(),e.node.getPosition());else{var s=O.distance(a.node.getPosition(),e.node.getPosition());s<i&&(n=a,i=s)}}return n},a.UnitDead=function(e){var t=this.camp[e.team].indexOf(e);if(!(t>-1))throw new Error("No Such a Unit!");this.camp[e.team].splice(t,1),this.types[e.type].push(e),e.node.active=!1},t}(h)).instance=void 0,x=t((w=T).prototype,"basic",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(w.prototype,"unitPrefabs",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),N=t(w.prototype,"units",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=w))||U));a._RF.pop()}}}));

System.register("chunks:///_virtual/UnitsRenderer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UnitsManager.ts"],(function(n){var t,e,r,o,i;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,r=n._decorator,o=n.Component},function(n){i=n.UnitsManager}],execute:function(){var s;e._RF.push({},"a5a87FtSwRMM6qv77HwfUxH","UnitsRenderer",void 0);var a=r.ccclass;r.property,n("UnitsRenderer",a("UnitsRenderer")(s=function(n){function e(){return n.apply(this,arguments)||this}t(e,n);var r=e.prototype;return r.start=function(){},r.onLoad=function(){},r.update=function(n){for(var t=[],e=0;e<i.instance.camp.length;e++)for(var r=0;r<i.instance.camp[e].length;r++)t.push(i.instance.camp[e][r]);t.sort((function(n,t){return t.node.getPosition().y-n.node.getPosition().y}));for(var o=0;o<t.length;o++)t[o].node.setSiblingIndex(o)},e}(o))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/UnitTypeInform.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,n,t,i,o,a,c;return{setters:[function(e){r=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,c=e.Component}],execute:function(){var l,p,u,s,f;o._RF.push({},"d2cf9yP80FO470h+CJWlrIM","UnitTypeInform",void 0);var y=a.ccclass,h=a.property;e("UnitType",function(e){return e[e.basic=0]="basic",e[e.shooter=1]="shooter",e[e.CircularSpellMagician=2]="CircularSpellMagician",e[e.core=3]="core",e[e.healer=4]="healer",e[e.miner=5]="miner",e}({})),e("UnitTypeInform",(l=y("UnitTypeInform"),p=h(c),l((f=r((s=function(e){function r(){for(var r,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return r=e.call.apply(e,[this].concat(o))||this,t(r,"Unit",f,i(r)),r}n(r,e);var o=r.prototype;return o.onLoad=function(){},o.start=function(){},o.update=function(e){},r}(c)).prototype,"Unit",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=s))||u));o._RF.pop()}}}));

System.register("chunks:///_virtual/whitePoint.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Resource.ts","./ResourceTypeInform.ts"],(function(t){var e,o,n,i,r,c;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator},function(t){i=t.Resource},function(t){r=t.ResourceType,c=t.ResourceTypeInform}],execute:function(){var s;o._RF.push({},"aaeb7MKZrxKpbYkNJj6IGNV","whitePoint",void 0);var u=n.ccclass;n.property,t("whitePoint",u("whitePoint")(s=function(t){function o(){return t.apply(this,arguments)||this}e(o,t);var n=o.prototype;return n.setMyType=function(){this.type=r.whitePoint},n.loader=function(e){this.collectTime=5,t.prototype.loader.call(this,e)},n.onLoad=function(){this.node.getComponent(c).resource=this},n.update=function(t){},o}(i))||s);o._RF.pop()}}}));

System.register("chunks:///_virtual/wMapGuider.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Map.ts"],(function(r){var e,t,i,n,o,a;return{setters:[function(r){e=r.inheritsLoose,t=r.createForOfIteratorHelperLoose},function(r){i=r.cclegacy,n=r.Vec2},function(r){o=r.Point,a=r.wMap}],execute:function(){function h(r,e){var t=e.x-r.x,i=e.y-r.y;return Math.sqrt(t*t+i*i)}i._RF.push({},"26138Kr291NnoUm9+FytwXr","wMapGuider",void 0);var u=r("PriorityQueue",function(){function r(r){void 0===r&&(r=function(r,e){return r-e}),this.heap=void 0,this.compareFn=void 0,this.heap=[],this.compareFn=r}var e=r.prototype;return e.toArray=function(){return this.heap.slice()},e.isEmpty=function(){return 0==this.heap.length},e.enqueue=function(r){this.heap.push(r),this.siftUp(this.heap.length-1)},e.dequeue=function(){if(0!==this.heap.length){if(1===this.heap.length)return this.heap.pop();var r=this.heap[0],e=this.heap.pop();return void 0!==e&&(this.heap[0]=e,this.siftDown(0)),r}},e.peek=function(){return this.heap.length>0?this.heap[0]:void 0},e.updatePriority=function(r){for(var e=0;e<this.heap.length;e++)if(this.heap[e]===r)return this.siftUp(e),this.siftDown(e),!0;return!1},e.siftUp=function(r){for(var e=Math.floor((r-1)/2);r>0&&this.compareFn(this.heap[r],this.heap[e])<0;){var t=[this.heap[e],this.heap[r]];this.heap[r]=t[0],this.heap[e]=t[1],r=e,e=Math.floor((r-1)/2)}},e.siftDown=function(r){var e=this.heap.length,t=2*r+1,i=2*r+2,n=r;if(t<e&&this.compareFn(this.heap[t],this.heap[n])<0&&(n=t),i<e&&this.compareFn(this.heap[i],this.heap[n])<0&&(n=i),n!==r){var o=[this.heap[n],this.heap[r]];this.heap[r]=o[0],this.heap[n]=o[1],this.siftDown(n)}},r}());var s=r("guiderPoint",function(r){function i(e,t){var i;return(i=r.call(this,e,t)||this).neighbors=[],i}e(i,r);var n=i.prototype;return n.linkNeighbor=function(r){r!=this?-1==this.neighbors.indexOf(r)&&(this.neighbors.push(r),r.neighbors.push(this)):console.log("Jump Point can not link itself!")},n.hasNeighbor=function(r){return-1!=this.neighbors.indexOf(r)},n.removeNeighbors=function(){for(var r,e=t(this.neighbors);!(r=e()).done;){var i=r.value,n=i.neighbors.indexOf(this);if(-1==n)throw new Error("the neighbor do not exist when try to remove neighbor!");i.neighbors.splice(n,1)}this.neighbors.length=0},i}(o));r("wMapGuider",function(r){function i(e,t,i,n,o){var a;(a=r.call(this,e,t,i,n,o)||this).JumpNodes=[];for(var h=0;h<i.length;h++)a.FindJumpNode(h),a.LinkJumpNode(h);return a}e(i,r);var a=i.prototype;return a.FindJumpNode=function(r){for(var e=this,i=new Map,n=1;n<this.width-1;n++)for(var a=function(){if(e.Array[h][n]==r){var a=function(r){var e=u[r%8];if(null==e)throw new Error("error in add jumpNode");for(var n,o=t(i.keys());!(n=o()).done;){var a=n.value;if(a.x==e.x&&a.y==e.y)return}i.set(e,new s(e.x,e.y))},u=(e.Array,[]);u[0]=new o(n-1,h-1),u[1]=new o(n,h-1),u[2]=new o(n+1,h-1),u[3]=new o(n+1,h),u[4]=new o(n+1,h+1),u[5]=new o(n,h+1),u[6]=new o(n-1,h+1),u[7]=new o(n-1,h);for(var f=null,p=0;p<8;p++)if(e.getmap(u[p].x,u[p].y)==r){f=p;break}if(null==f)return a(1),a(3),a(5),a(7),0;for(var l=0,v=(f+1)%8,y=0,c=(f+1)%8,g=(f+1)%8,w=0;w<9;w++)e.getmap(u[g].x,u[g].y)==r?(y>l&&(l=y,v=c),c=g+1,y=0):y++,g=(g+1)%8;if(l<=3)return 0;if(4==l)a((v+1)%2==0?v+1:v+2);else if(5==l)a((2*v+l-1)/2);else if(l>5)for(var x=1;x<l-1;x++)(v+x)%2==1&&a(v+x)}},h=1;h<this.height-1;h++)a();this.JumpNodes[r]=i},a.LinkJumpNode=function(r){for(var e,i=[],n=t(this.JumpNodes[r].values());!(e=n()).done;){var o=e.value;i.push(o)}for(var a=0;a<i.length;a++)for(var h=a+1;h<i.length;h++)this.isReachable(i[a],i[h],r)&&i[a].linkNeighbor(i[h])},a.isReachable=function(r,e,t){var i,a,h=0,u=1,s=new o(r.x,r.y);if(e.x-r.x==0){if(e.y-r.y==0)return!0;a=new n(0,1),e.y<r.y&&(a.y=-1);for(var f=r.x,p=r.y+a.y;p!=e.y;p+=a.y)if(this.getmap(f,p)==t)return!1;return!0}if(e.y==r.y){i=new n(1,0),e.x<r.x&&(i.x=-1);for(var l=r.y,v=r.x+i.x;v!=e.x;v+=i.x)if(this.getmap(v,l)==t)return!1;return!0}a=new n(0,1),i=new n(1,0),e.x<r.x&&(i.x=-1),e.y<r.y&&(a.y=-1);var y=Math.abs((e.y-r.y)/(e.x-r.x));if(y>1){i.multiplyScalar(1/y);var c=i;i=a,a=c,h=1,u=0}else a.multiplyScalar(y);var g=new n(0,0);function w(r){if(r>0)return 1;if(r<0)return-1;throw new Error("?")}g=i.clone().add(a),0==h?(i.x=w(i.x),a.y=w(a.y)):(i.y=w(i.y),a.x=w(a.x)),s.x+=.5,s.y+=.5;var x=s.array(u);function d(r){if(0==h){if(1==i.x)return Math.floor(r.x);if(-1==i.x)return-Math.floor(1-r.x);throw new Error("?")}if(1==a.x)return Math.floor(r.x);if(-1==a.x)return-Math.floor(1-r.x);throw new Error("?")}function m(r){if(1==h){if(1==i.y)return Math.floor(r.y);if(-1==i.y)return-Math.floor(1-r.y);throw new Error("?")}if(1==a.y)return Math.floor(r.y);if(-1==a.y)return-Math.floor(1-r.y);throw new Error("?")}for(s.add(g.clone().multiplyScalar(.5));s.array(h)!=e.array(h)+1;){if(this.getmap(d(s),m(s))==t)return!1;if(m(new o(0,x))!=m(s))if(m(s)==s.array(u)){var b=new o(s.x,s.y),M=new o(s.x,s.y);if(b.sub(i),M.sub(a),this.getmap(d(b),m(b))==t&&this.getmap(d(M),m(M))==t)return!1}else{var N=new o(s.x,s.y);if(N.sub(i),this.getmap(d(N),m(N))==t)return!1}s.add(g)}return!0},a.searchBestWay=function(r,e,i){if(this.getmap(r.x,r.y)==i||this.getmap(e.x,e.y)==i)return null;var n=[],a=new s(r.x,r.y),f=new s(e.x,e.y),p=!1,l=!1;if(this.isReachable(a,f,i))return n.push(r),n.push(e),n;for(var v,y=[],c=t(this.JumpNodes[i].values());!(v=c()).done;){var g=v.value;y.push(g),g.isEqual(a)&&(a=g,p=!0),g.isEqual(f)&&(f=g,l=!0)}var w=y.length;if(y.push(a),y.push(f),!p)for(var x=0;x<w;x++)this.isReachable(a,y[x],i)&&a.linkNeighbor(y[x]);if(!l)for(var d=0;d<w;d++)this.isReachable(f,y[d],i)&&f.linkNeighbor(y[d]);var m=function(r,e){var i=new u((function(r,e){return r.f-e.f})),n=new Set,o={point:r,g:0,h:h(r,e),f:0+h(r,e),parent:null};for(i.enqueue(o);!i.isEmpty();){var a=i.dequeue();if(a.point===e){for(var s=[],f=a;null!==f;)s.unshift(f.point),f=f.parent;return s}n.add(a.point);for(var p,l=t(a.point.neighbors);!(p=l()).done;){var v=p.value;if(!n.has(v)){for(var y,c=a.g+Math.sqrt(Math.pow(a.point.x-v.x,2)+Math.pow(a.point.y-v.y,2)),g=null,w=t(i.toArray());!(y=w()).done;){var x=y.value;if(x.point===v){g=x;break}}null===g?(g={point:v,g:c,h:h(v,e),f:c+h(v,e),parent:a},i.enqueue(g)):c<g.g&&(g.g=c,g.f=c+g.h,i.updatePriority(g))}}}return null}(a,f);if(null==m)return null;for(var b,M=t(m);!(b=M()).done;){var N=b.value;n.push(new o(N.x,N.y))}return p||a.removeNeighbors(),l||f.removeNeighbors(),n},i}(a));i._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});